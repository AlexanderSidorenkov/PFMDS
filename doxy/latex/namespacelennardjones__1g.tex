\hypertarget{namespacelennardjones__1g}{}\section{Модуль lennardjones\+\_\+1g}
\label{namespacelennardjones__1g}\index{lennardjones\+\_\+1g@{lennardjones\+\_\+1g}}
\subsection*{Типы данных}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structlennardjones__1g_1_1lennardjones1g__parameters}{lennardjones1g\+\_\+parameters}}
\end{DoxyCompactItemize}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacelennardjones__1g_aaf09aeeacdbe2a76adad336dde195938}{read\+\_\+lj1g\+\_\+parameters}} (L\+Jp, filename)
\item 
subroutine \mbox{\hyperlink{namespacelennardjones__1g_ad0b0c6184262c754f7daa91a179657ef}{lj1g\+\_\+energy}} (energy, nl, L\+Jp)
\item 
subroutine \mbox{\hyperlink{namespacelennardjones__1g_a2581bad1eb2a8f6b8ecaa6d09de8f226}{lj1g\+\_\+forces}} (atoms, nl, L\+Jp)
\item 
real function \mbox{\hyperlink{namespacelennardjones__1g_a3bf6806cd81693117d84cb3f91adc6d5}{scalar\+\_\+lj\+\_\+force}} (r, R1, R2, c12, c6, c12t12, c6t6)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacelennardjones__1g_ad0b0c6184262c754f7daa91a179657ef}\label{namespacelennardjones__1g_ad0b0c6184262c754f7daa91a179657ef}} 
\index{lennardjones\+\_\+1g@{lennardjones\+\_\+1g}!lj1g\+\_\+energy@{lj1g\+\_\+energy}}
\index{lj1g\+\_\+energy@{lj1g\+\_\+energy}!lennardjones\+\_\+1g@{lennardjones\+\_\+1g}}
\subsubsection{\texorpdfstring{lj1g\+\_\+energy()}{lj1g\_energy()}}
{\footnotesize\ttfamily subroutine lennardjones\+\_\+1g\+::lj1g\+\_\+energy (\begin{DoxyParamCaption}\item[{real}]{energy,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structlennardjones__1g_1_1lennardjones1g__parameters}{lennardjones1g\+\_\+parameters}})}]{L\+Jp }\end{DoxyParamCaption})}



См. определение в файле Lennard\+Jones\+\_\+1g.\+f90 строка 29


\begin{DoxyCode}
29     \textcolor{keywordtype}{type}(neighbour\_list):: nl
30     \textcolor{keywordtype}{type}(LennardJones1g\_parameters):: LJp
31     \textcolor{keywordtype}{integer}:: i,p
32     \textcolor{keywordtype}{real}:: energy,energy\_priv,U
33     
34     energy = 0.
35     energy\_priv = 0.
36     \textcolor{comment}{!$OMP PARALLEL firstprivate(energy\_priv) private(i,p,U)}
37     \textcolor{comment}{!$OMP DO schedule(dynamic,chunk\_size)}
38     \textcolor{keywordflow}{do} i=1,nl%N
39         \textcolor{keywordflow}{do} p=1,nl%lessnnum(i)\textcolor{comment}{!do p=1,nl%nnum(i)!if (nl%nlist(p,i)>i) exit}
40             u = 1./(nl%moddr(p,i)*nl%moddr(p,i)*nl%moddr(p,i)*nl%moddr(p,i)*nl%moddr(p,i)*nl%moddr(p,i))
41             energy\_priv = energy\_priv+u*(ljp%c12*u-ljp%c6)*f\_cut(nl%moddr(p,i),ljp%R1,ljp%R2)
42 \textcolor{keywordflow}{        enddo}
43 \textcolor{keywordflow}{    enddo}
44     \textcolor{comment}{!$OMP END DO}
45     \textcolor{comment}{!$OMP ATOMIC}
46         energy = energy+energy\_priv
47     \textcolor{comment}{!$OMP END PARALLEL}
48     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{namespacelennardjones__1g_ad0b0c6184262c754f7daa91a179657ef_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelennardjones__1g_a2581bad1eb2a8f6b8ecaa6d09de8f226}\label{namespacelennardjones__1g_a2581bad1eb2a8f6b8ecaa6d09de8f226}} 
\index{lennardjones\+\_\+1g@{lennardjones\+\_\+1g}!lj1g\+\_\+forces@{lj1g\+\_\+forces}}
\index{lj1g\+\_\+forces@{lj1g\+\_\+forces}!lennardjones\+\_\+1g@{lennardjones\+\_\+1g}}
\subsubsection{\texorpdfstring{lj1g\+\_\+forces()}{lj1g\_forces()}}
{\footnotesize\ttfamily subroutine lennardjones\+\_\+1g\+::lj1g\+\_\+forces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structlennardjones__1g_1_1lennardjones1g__parameters}{lennardjones1g\+\_\+parameters}})}]{L\+Jp }\end{DoxyParamCaption})}



См. определение в файле Lennard\+Jones\+\_\+1g.\+f90 строка 52


\begin{DoxyCode}
52     \textcolor{keywordtype}{type}(particles) ::  atoms
53     \textcolor{keywordtype}{type}(neighbour\_list) :: nl
54     \textcolor{keywordtype}{type}(LennardJones1g\_parameters) :: LJp
55     \textcolor{keywordtype}{integer}:: i,p,k,ind,jnd
56     \textcolor{keywordtype}{real},\textcolor{keywordtype}{allocatable}:: priv\_force(:,:),F(:),fp(:,:)
57     
58     \textcolor{comment}{!$OMP PARALLEL private(i,p,k,ind,jnd,F,fp,priv\_force)}
59     \textcolor{keywordflow}{if}(.not. \textcolor{keyword}{allocated}(priv\_force)) \textcolor{keyword}{allocate}(priv\_force(3,atoms%N))\textcolor{comment}{!realloc if N changed}
60     \textcolor{keywordflow}{if}(.not. \textcolor{keyword}{allocated}(f)) \textcolor{keyword}{allocate}(f(nl%neighb\_num\_max))\textcolor{comment}{!realloc if neighb\_num\_max changed}
61     \textcolor{keywordflow}{if}(.not. \textcolor{keyword}{allocated}(fp)) \textcolor{keyword}{allocate}(fp(3,nl%neighb\_num\_max))\textcolor{comment}{!realloc if neighb\_num\_max changed}
62     f = 0.
63     fp = 0.
64     priv\_force = 0. 
65     \textcolor{comment}{!$OMP DO SCHEDULE(dynamic,chunk\_size)    }
66     \textcolor{keywordflow}{do} i=1,nl%N
67         \textcolor{keywordflow}{do} p=1,nl%lessnnum(i)
68             f(p) = scalar\_lj\_force(nl%moddr(p,i),ljp%R1,ljp%R2,ljp%c12,ljp%c6,ljp%c12t12,ljp%c6t6)
69 \textcolor{keywordflow}{        enddo}
70         \textcolor{keywordflow}{do} p=1,nl%lessnnum(i)
71             fp(1,p) = f(p)*nl%dr(1,p,i)
72             fp(2,p) = f(p)*nl%dr(2,p,i)
73             fp(3,p) = f(p)*nl%dr(3,p,i)
74 \textcolor{keywordflow}{        enddo}
75         \textcolor{keywordflow}{do} p=1,nl%lessnnum(i)
76             ind = nl%particle\_index(i)
77             jnd = nl%particle\_index(nl%nlist(p,i))
78             priv\_force(1,ind) = priv\_force(1,ind)-fp(1,p)
79             priv\_force(2,ind) = priv\_force(2,ind)-fp(2,p)
80             priv\_force(3,ind) = priv\_force(3,ind)-fp(3,p)
81             priv\_force(1,jnd) = priv\_force(1,jnd)+fp(1,p)
82             priv\_force(2,jnd) = priv\_force(2,jnd)+fp(2,p)
83             priv\_force(3,jnd) = priv\_force(3,jnd)+fp(3,p)
84 \textcolor{keywordflow}{        enddo}
85 \textcolor{keywordflow}{    enddo}
86     \textcolor{comment}{!$OMP END DO}
87     \textcolor{keywordflow}{do} i=1,nl%N
88         \textcolor{keywordflow}{do} k=1,3
89             \textcolor{comment}{!$OMP ATOMIC}
90                 atoms%forces(k,i) = atoms%forces(k,i)+priv\_force(k,i)
91 \textcolor{keywordflow}{        enddo}
92 \textcolor{keywordflow}{    enddo}
93     \textcolor{comment}{!$OMP END PARALLEL}
94     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacelennardjones__1g_a2581bad1eb2a8f6b8ecaa6d09de8f226_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelennardjones__1g_aaf09aeeacdbe2a76adad336dde195938}\label{namespacelennardjones__1g_aaf09aeeacdbe2a76adad336dde195938}} 
\index{lennardjones\+\_\+1g@{lennardjones\+\_\+1g}!read\+\_\+lj1g\+\_\+parameters@{read\+\_\+lj1g\+\_\+parameters}}
\index{read\+\_\+lj1g\+\_\+parameters@{read\+\_\+lj1g\+\_\+parameters}!lennardjones\+\_\+1g@{lennardjones\+\_\+1g}}
\subsubsection{\texorpdfstring{read\+\_\+lj1g\+\_\+parameters()}{read\_lj1g\_parameters()}}
{\footnotesize\ttfamily subroutine lennardjones\+\_\+1g\+::read\+\_\+lj1g\+\_\+parameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structlennardjones__1g_1_1lennardjones1g__parameters}{lennardjones1g\+\_\+parameters}})}]{L\+Jp,  }\item[{character($\ast$)}]{filename }\end{DoxyParamCaption})}



См. определение в файле Lennard\+Jones\+\_\+1g.\+f90 строка 14


\begin{DoxyCode}
14     \textcolor{keywordtype}{type}(LennardJones1g\_parameters):: LJp
15     \textcolor{keywordtype}{character(*)}::  filename
16     
17     \textcolor{keyword}{open}(1,file=filename)
18     \textcolor{keyword}{read}(1,*) ljp%eps,ljp%sig
19     \textcolor{keyword}{read}(1,*) ljp%R1,ljp%R2
20     \textcolor{keyword}{close}(1)
21     ljp%c6 = 4.*ljp%eps*ljp%sig**6
22     ljp%c12 = 4.*ljp%eps*ljp%sig**12
23     ljp%c6t6 = 6.*4.*ljp%eps*ljp%sig**6
24     ljp%c12t12 = 12.*4.*ljp%eps*ljp%sig**12
25     
\end{DoxyCode}
\mbox{\Hypertarget{namespacelennardjones__1g_a3bf6806cd81693117d84cb3f91adc6d5}\label{namespacelennardjones__1g_a3bf6806cd81693117d84cb3f91adc6d5}} 
\index{lennardjones\+\_\+1g@{lennardjones\+\_\+1g}!scalar\+\_\+lj\+\_\+force@{scalar\+\_\+lj\+\_\+force}}
\index{scalar\+\_\+lj\+\_\+force@{scalar\+\_\+lj\+\_\+force}!lennardjones\+\_\+1g@{lennardjones\+\_\+1g}}
\subsubsection{\texorpdfstring{scalar\+\_\+lj\+\_\+force()}{scalar\_lj\_force()}}
{\footnotesize\ttfamily real function lennardjones\+\_\+1g\+::scalar\+\_\+lj\+\_\+force (\begin{DoxyParamCaption}\item[{real, intent(in)}]{r,  }\item[{real, intent(in)}]{R1,  }\item[{real, intent(in)}]{R2,  }\item[{real, intent(in)}]{c12,  }\item[{real, intent(in)}]{c6,  }\item[{real, intent(in)}]{c12t12,  }\item[{real, intent(in)}]{c6t6 }\end{DoxyParamCaption})}



См. определение в файле Lennard\+Jones\+\_\+1g.\+f90 строка 98


\begin{DoxyCode}
98     \textcolor{comment}{!$OMP DECLARE SIMD(scalar\_lj\_force) UNIFORM(R1,R2,c12,c6,c12t12,c6t6)}
99     \textcolor{keywordtype}{real}, \textcolor{keywordtype}{intent(in)} :: r
100     \textcolor{keywordtype}{real}, \textcolor{keywordtype}{intent(in)} :: R1,R2,c12,c6,c12t12,c6t6
101     \textcolor{keywordtype}{real} scalar\_lj\_force
102     \textcolor{keywordtype}{real} :: invr2,U,fcut,dfrcut
103     
104     invr2 = 1./(r*r)
105     u = invr2*invr2*invr2
106     \textcolor{keyword}{call }f\_dfr\_cut(fcut,dfrcut,r,r1,r2)
107     scalar\_lj\_force = u*invr2*((c12t12*u-c6t6)*fcut-(c12*u-c6)*dfrcut)
108     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacelennardjones__1g_a3bf6806cd81693117d84cb3f91adc6d5_cgraph}
\end{center}
\end{figure}
