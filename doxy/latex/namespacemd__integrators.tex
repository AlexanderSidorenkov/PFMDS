\hypertarget{namespacemd__integrators}{}\section{Модуль md\+\_\+integrators}
\label{namespacemd__integrators}\index{md\+\_\+integrators@{md\+\_\+integrators}}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a46897b8968c1901883654589ef731eb2}{integrate\+\_\+verlet\+\_\+xyz\+\_\+positions}} (atoms, group, steps, box)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a89e015a65c39454223a09736f095aef0}{integrate\+\_\+verlet\+\_\+z\+\_\+positions}} (atoms, group, steps, box)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a4aafa379de6ec22530aa0c426855689e}{integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities}} (atoms, group, steps)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_ab71be6f8ca48e91d1a0e84d70b3176ac}{integrate\+\_\+verlet\+\_\+z\+\_\+velocities}} (atoms, group, steps)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a37c12502ddb5537b8b963074dcd33132}{molecular\+\_\+static\+\_\+xyz\+\_\+velocities}} (atoms, group)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_aa4c7e5a4cfdd19fa542fccae43e9d35a}{molecular\+\_\+static\+\_\+1d\+\_\+velocities}} (atoms, group)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_afaf5cf45b5c0a8363d40dc012c954a1a}{zero\+\_\+forces}} (atoms, group)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_aa74788b2d003c16024b8eb999ea01c3c}{create\+\_\+nose\+\_\+hoover\+\_\+chain}} (nhc)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a20d655980db9ce88983d738fc91ff021}{set\+\_\+nose\+\_\+hoover\+\_\+chain}} (nhc, temp, q1, l)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a769781abbe7ac3aaacf761d6321d4722}{integrate\+\_\+nose\+\_\+hoover\+\_\+chain}} (nhc, atoms, group, dt)
\item 
subroutine \mbox{\hyperlink{namespacemd__integrators_a67084641a81f648ac71c15c20428c015}{calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy}} (nhc)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacemd__integrators_a67084641a81f648ac71c15c20428c015}\label{namespacemd__integrators_a67084641a81f648ac71c15c20428c015}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy@{calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy}}
\index{calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy@{calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy()}{calculate\_nose\_hoover\_chain\_energy()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::calculate\+\_\+nose\+\_\+hoover\+\_\+chain\+\_\+energy (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1nose__hoover__chain}{nose\+\_\+hoover\+\_\+chain}})}]{nhc }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 242


\begin{DoxyCode}
242     \textcolor{keywordtype}{type}(nose\_hoover\_chain):: nhc
243     \textcolor{keywordtype}{real}:: kt
244     \textcolor{keywordtype}{integer}::       i
245 
246     kt=1.3806488/1.6021765654*10.**(-4)*nhc%temperature
247 
248     nhc%e = nhc%q(1)/2*nhc%v(1)**2+3.*nhc%L*kt*nhc%x(1)
249     \textcolor{keywordflow}{do} i=2,nhc%M,1
250         nhc%e = nhc%e+nhc%q(i)/2*nhc%v(i)**2+kt*nhc%x(i)
251 \textcolor{keywordflow}{    enddo}
252 
253     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_aa74788b2d003c16024b8eb999ea01c3c}\label{namespacemd__integrators_aa74788b2d003c16024b8eb999ea01c3c}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!create\+\_\+nose\+\_\+hoover\+\_\+chain@{create\+\_\+nose\+\_\+hoover\+\_\+chain}}
\index{create\+\_\+nose\+\_\+hoover\+\_\+chain@{create\+\_\+nose\+\_\+hoover\+\_\+chain}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{create\+\_\+nose\+\_\+hoover\+\_\+chain()}{create\_nose\_hoover\_chain()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::create\+\_\+nose\+\_\+hoover\+\_\+chain (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1nose__hoover__chain}{nose\+\_\+hoover\+\_\+chain}})}]{nhc }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 167


\begin{DoxyCode}
167     \textcolor{keywordtype}{type}(nose\_hoover\_chain):: nhc
168 
169     \textcolor{keyword}{allocate}(nhc%x(nhc%M))
170     \textcolor{keyword}{allocate}(nhc%v(nhc%M))
171     \textcolor{keyword}{allocate}(nhc%q(nhc%M))
172     nhc%x = 0.
173     nhc%v = 0.
174     nhc%q = 0.
175     nhc%e = 0.
176     nhc%s = 1.
177 
178     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_a769781abbe7ac3aaacf761d6321d4722}\label{namespacemd__integrators_a769781abbe7ac3aaacf761d6321d4722}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!integrate\+\_\+nose\+\_\+hoover\+\_\+chain@{integrate\+\_\+nose\+\_\+hoover\+\_\+chain}}
\index{integrate\+\_\+nose\+\_\+hoover\+\_\+chain@{integrate\+\_\+nose\+\_\+hoover\+\_\+chain}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{integrate\+\_\+nose\+\_\+hoover\+\_\+chain()}{integrate\_nose\_hoover\_chain()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::integrate\+\_\+nose\+\_\+hoover\+\_\+chain (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1nose__hoover__chain}{nose\+\_\+hoover\+\_\+chain}})}]{nhc,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1time__steps}{time\+\_\+steps}})}]{dt }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 197


\begin{DoxyCode}
197     \textcolor{keywordtype}{type}(particles)::   atoms
198     \textcolor{keywordtype}{type}(particle\_group):: group
199     \textcolor{keywordtype}{type}(time\_steps):: dt
200     \textcolor{keywordtype}{type}(nose\_hoover\_chain):: nhc
201     \textcolor{keywordtype}{real}:: kedif,ke,kt,b
202     \textcolor{keywordtype}{integer}::       i
203 
204     \textcolor{keyword}{call }calculate\_kinetic\_energy(ke,atoms,group)
205     kt=1.3806488/1.6021765654*10.**(-4)*nhc%temperature
206     kedif = 2.*ke-3.*nhc%L*kt
207 
208     \textcolor{keywordflow}{if} (nhc%M==1) \textcolor{keywordflow}{then}
209         nhc%v(1)=nhc%v(1)+kedif/nhc%q(1)*dt%ts(3)
210     \textcolor{keywordflow}{else}
211         nhc%v(nhc%M)=nhc%v(nhc%M)+(nhc%q(nhc%M-1)*nhc%v(nhc%M-1)**2-kt)/nhc%q(nhc%M)*dt%ts(3)
212         \textcolor{keywordflow}{do} i=nhc%M-1,2,-1
213             b=exp(-nhc%v(i+1)*dt%ts(4))
214             nhc%v(i)=nhc%v(i)*b**2+(nhc%q(i-1)*nhc%v(i-1)**2-kt)/nhc%q(i)*dt%ts(3)*b
215 \textcolor{keywordflow}{        enddo}
216         b=exp(-nhc%v(2)*dt%ts(4))
217         nhc%v(1)=nhc%v(1)*b**2+kedif/nhc%q(1)*dt%ts(3)*b
218 \textcolor{keywordflow}{    endif}
219 
220     nhc%s=exp(-nhc%v(1)*dt%ts(2))
221     \textcolor{keyword}{call }scale\_velocities(atoms,group,nhc%s)
222     kedif = 2.*ke*nhc%s**2-3.*nhc%L*kt
223     \textcolor{keywordflow}{do} i=1,nhc%M,1
224         nhc%x(i)=nhc%x(i)+nhc%v(i)*dt%ts(2)
225 \textcolor{keywordflow}{    enddo}
226 
227     \textcolor{keywordflow}{if} (nhc%M==1) \textcolor{keywordflow}{then}
228         nhc%v(1)=nhc%v(1)+kedif/nhc%q(1)*dt%ts(3)
229     \textcolor{keywordflow}{else}
230         nhc%v(1)=nhc%v(1)*b**2+kedif/nhc%q(1)*dt%ts(3)*b
231         \textcolor{keywordflow}{do} i=2,nhc%M-1,1
232             b=exp(-nhc%v(i+1)*dt%ts(4))
233             nhc%v(i)=nhc%v(i)*b**2+(nhc%q(i-1)*nhc%v(i-1)**2-kt)/nhc%q(i)*dt%ts(3)*b
234 \textcolor{keywordflow}{        enddo}
235         nhc%v(nhc%M)=nhc%v(nhc%M)+(nhc%q(nhc%M-1)*nhc%v(nhc%M-1)**2-kt)/nhc%q(nhc%M)*dt%ts(3)
236 \textcolor{keywordflow}{    endif}
237 
238     \textcolor{keywordflow}{return}
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__integrators_a769781abbe7ac3aaacf761d6321d4722_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__integrators_a46897b8968c1901883654589ef731eb2}\label{namespacemd__integrators_a46897b8968c1901883654589ef731eb2}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!integrate\+\_\+verlet\+\_\+xyz\+\_\+positions@{integrate\+\_\+verlet\+\_\+xyz\+\_\+positions}}
\index{integrate\+\_\+verlet\+\_\+xyz\+\_\+positions@{integrate\+\_\+verlet\+\_\+xyz\+\_\+positions}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{integrate\+\_\+verlet\+\_\+xyz\+\_\+positions()}{integrate\_verlet\_xyz\_positions()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::integrate\+\_\+verlet\+\_\+xyz\+\_\+positions (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1time__steps}{time\+\_\+steps}})}]{steps,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 8


\begin{DoxyCode}
8     \textcolor{keywordtype}{type}(particles)::   atoms
9     \textcolor{keywordtype}{type}(particle\_group):: group
10     \textcolor{keywordtype}{type}(time\_steps):: steps
11     \textcolor{keywordtype}{type}(simulation\_cell):: box
12     \textcolor{keywordtype}{integer}::       i,k,ind
13 
14     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,ind,k)}
15     \textcolor{comment}{!$OMP DO}
16     \textcolor{keywordflow}{do} ind=1,group%N
17         i = group%indexes(ind)
18         \textcolor{keywordflow}{do} k=1,3
19             atoms%positions(k,i) = atoms%positions(k,i)+atoms%velocities(k,i)*steps%ts(1)
20             \textcolor{keywordflow}{if} (atoms%positions(k,i)>box%box\_size(k)) \textcolor{keywordflow}{then}
21                 atoms%positions(k,i) = atoms%positions(k,i)-box%box\_size(k)
22             \textcolor{keywordflow}{elseif} (atoms%positions(k,i)<0.) \textcolor{keywordflow}{then}
23                 atoms%positions(k,i) = atoms%positions(k,i)+box%box\_size(k)
24 \textcolor{keywordflow}{            endif}
25 \textcolor{keywordflow}{        enddo}
26 \textcolor{keywordflow}{    enddo}
27     \textcolor{comment}{!$OMP END DO}
28     \textcolor{comment}{!$OMP END PARALLEL}
29 
30     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_a4aafa379de6ec22530aa0c426855689e}\label{namespacemd__integrators_a4aafa379de6ec22530aa0c426855689e}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities@{integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities}}
\index{integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities@{integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities()}{integrate\_verlet\_xyz\_velocities()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::integrate\+\_\+verlet\+\_\+xyz\+\_\+velocities (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1time__steps}{time\+\_\+steps}})}]{steps }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 59


\begin{DoxyCode}
59     \textcolor{keywordtype}{type}(particles)::   atoms
60     \textcolor{keywordtype}{type}(particle\_group):: group
61     \textcolor{keywordtype}{type}(time\_steps):: steps
62     \textcolor{keywordtype}{real},\textcolor{keywordtype}{parameter}:: mass\_coef=1.6605389217/1.6021765654*10.**(2)
63     \textcolor{keywordtype}{integer}::       i,ind,k
64 
65     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,ind,k)}
66     \textcolor{comment}{!$OMP DO}
67     \textcolor{keywordflow}{do} ind=1,group%N
68         i = group%indexes(ind)
69         \textcolor{keywordflow}{do} k=1,3
70             atoms%velocities(k,i) = atoms%velocities(k,i)+atoms%forces(k,i)/atoms%masses(i)/mass\_coef*steps
      %ts(2)
71 \textcolor{keywordflow}{        enddo}
72 \textcolor{keywordflow}{    enddo}
73     \textcolor{comment}{!$OMP END DO}
74     \textcolor{comment}{!$OMP END PARALLEL}
75 
76     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_a89e015a65c39454223a09736f095aef0}\label{namespacemd__integrators_a89e015a65c39454223a09736f095aef0}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!integrate\+\_\+verlet\+\_\+z\+\_\+positions@{integrate\+\_\+verlet\+\_\+z\+\_\+positions}}
\index{integrate\+\_\+verlet\+\_\+z\+\_\+positions@{integrate\+\_\+verlet\+\_\+z\+\_\+positions}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{integrate\+\_\+verlet\+\_\+z\+\_\+positions()}{integrate\_verlet\_z\_positions()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::integrate\+\_\+verlet\+\_\+z\+\_\+positions (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1time__steps}{time\+\_\+steps}})}]{steps,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 34


\begin{DoxyCode}
34     \textcolor{keywordtype}{type}(particles)::   atoms
35     \textcolor{keywordtype}{type}(particle\_group):: group
36     \textcolor{keywordtype}{type}(time\_steps):: steps
37     \textcolor{keywordtype}{type}(simulation\_cell):: box
38     \textcolor{keywordtype}{integer}::       i,k,ind
39 
40     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,ind,k)}
41     \textcolor{comment}{!$OMP DO}
42     \textcolor{keywordflow}{do} ind=1,group%N
43         i = group%indexes(ind)
44         k = 3
45             atoms%positions(k,i) = atoms%positions(k,i)+atoms%velocities(k,i)*steps%ts(1)
46             \textcolor{keywordflow}{if} (atoms%positions(k,i)>box%box\_size(k)) \textcolor{keywordflow}{then}
47                 atoms%positions(k,i) = atoms%positions(k,i)-box%box\_size(k)
48             \textcolor{keywordflow}{elseif} (atoms%positions(k,i)<0.) \textcolor{keywordflow}{then}
49                 atoms%positions(k,i) = atoms%positions(k,i)+box%box\_size(k)
50 \textcolor{keywordflow}{            endif}
51 \textcolor{keywordflow}{    enddo}
52     \textcolor{comment}{!$OMP END DO}
53     \textcolor{comment}{!$OMP END PARALLEL}
54 
55     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_ab71be6f8ca48e91d1a0e84d70b3176ac}\label{namespacemd__integrators_ab71be6f8ca48e91d1a0e84d70b3176ac}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!integrate\+\_\+verlet\+\_\+z\+\_\+velocities@{integrate\+\_\+verlet\+\_\+z\+\_\+velocities}}
\index{integrate\+\_\+verlet\+\_\+z\+\_\+velocities@{integrate\+\_\+verlet\+\_\+z\+\_\+velocities}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{integrate\+\_\+verlet\+\_\+z\+\_\+velocities()}{integrate\_verlet\_z\_velocities()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::integrate\+\_\+verlet\+\_\+z\+\_\+velocities (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1time__steps}{time\+\_\+steps}})}]{steps }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 80


\begin{DoxyCode}
80     \textcolor{keywordtype}{type}(particles)::   atoms
81     \textcolor{keywordtype}{type}(particle\_group):: group
82     \textcolor{keywordtype}{type}(time\_steps):: steps
83     \textcolor{keywordtype}{real},\textcolor{keywordtype}{parameter}:: mass\_coef=1.6605389217/1.6021765654*10.**(2)
84     \textcolor{keywordtype}{integer}::       i,ind,k
85 
86     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,ind,k)}
87     \textcolor{comment}{!$OMP DO}
88     \textcolor{keywordflow}{do} ind=1,group%N
89         i = group%indexes(ind)
90         k = 3
91             atoms%velocities(k,i) = atoms%velocities(k,i)+atoms%forces(k,i)/atoms%masses(i)/mass\_coef*steps
      %ts(2)
92 \textcolor{keywordflow}{    enddo}
93     \textcolor{comment}{!$OMP END DO}
94     \textcolor{comment}{!$OMP END PARALLEL}
95 
96     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_aa4c7e5a4cfdd19fa542fccae43e9d35a}\label{namespacemd__integrators_aa4c7e5a4cfdd19fa542fccae43e9d35a}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!molecular\+\_\+static\+\_\+1d\+\_\+velocities@{molecular\+\_\+static\+\_\+1d\+\_\+velocities}}
\index{molecular\+\_\+static\+\_\+1d\+\_\+velocities@{molecular\+\_\+static\+\_\+1d\+\_\+velocities}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{molecular\+\_\+static\+\_\+1d\+\_\+velocities()}{molecular\_static\_1d\_velocities()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::molecular\+\_\+static\+\_\+1d\+\_\+velocities (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 126


\begin{DoxyCode}
126     \textcolor{keywordtype}{type}(particles)::   atoms
127     \textcolor{keywordtype}{type}(particle\_group):: group
128     \textcolor{keywordtype}{real}:: fv
129     \textcolor{keywordtype}{integer}:: i,k,ind
130 
131     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,k,ind,fv)}
132     \textcolor{comment}{!$OMP DO}
133     \textcolor{keywordflow}{do} ind=1,group%N
134         i = group%indexes(ind)
135         fv = sum(atoms%forces(:,i)*atoms%velocities(:,i))
136         \textcolor{keywordflow}{if} (fv>0.) \textcolor{keywordflow}{then}
137         \textcolor{keywordflow}{else}
138             atoms%velocities(:,i) = 0.
139 \textcolor{keywordflow}{        endif}
140 \textcolor{keywordflow}{    enddo}
141     \textcolor{comment}{!$OMP END DO}
142     \textcolor{comment}{!$OMP END PARALLEL}
143 
144     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_a37c12502ddb5537b8b963074dcd33132}\label{namespacemd__integrators_a37c12502ddb5537b8b963074dcd33132}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!molecular\+\_\+static\+\_\+xyz\+\_\+velocities@{molecular\+\_\+static\+\_\+xyz\+\_\+velocities}}
\index{molecular\+\_\+static\+\_\+xyz\+\_\+velocities@{molecular\+\_\+static\+\_\+xyz\+\_\+velocities}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{molecular\+\_\+static\+\_\+xyz\+\_\+velocities()}{molecular\_static\_xyz\_velocities()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::molecular\+\_\+static\+\_\+xyz\+\_\+velocities (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 100


\begin{DoxyCode}
100     \textcolor{keywordtype}{type}(particles)::   atoms
101     \textcolor{keywordtype}{type}(particle\_group):: group
102     \textcolor{keywordtype}{real}:: fv,ff
103     \textcolor{keywordtype}{integer}:: i,k,ind
104 
105     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,k,ind,fv,ff)}
106     \textcolor{comment}{!$OMP DO}
107     \textcolor{keywordflow}{do} ind=1,group%N
108         i = group%indexes(ind)
109         fv = sum(atoms%forces(:,i)*atoms%velocities(:,i))
110         ff = sum(atoms%forces(:,i)**2)
111         \textcolor{keywordflow}{if} (fv>0. .and. ff>10.**(-12) ) \textcolor{keywordflow}{then}
112             \textcolor{keywordflow}{do} k=1,3
113                 atoms%velocities(k,i) = fv/ff*atoms%forces(k,i)
114 \textcolor{keywordflow}{            enddo}
115         \textcolor{keywordflow}{else}
116             atoms%velocities(:,i) = 0.
117 \textcolor{keywordflow}{        endif}
118 \textcolor{keywordflow}{    enddo}
119     \textcolor{comment}{!$OMP END DO}
120     \textcolor{comment}{!$OMP END PARALLEL}
121 
122     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_a20d655980db9ce88983d738fc91ff021}\label{namespacemd__integrators_a20d655980db9ce88983d738fc91ff021}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!set\+\_\+nose\+\_\+hoover\+\_\+chain@{set\+\_\+nose\+\_\+hoover\+\_\+chain}}
\index{set\+\_\+nose\+\_\+hoover\+\_\+chain@{set\+\_\+nose\+\_\+hoover\+\_\+chain}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{set\+\_\+nose\+\_\+hoover\+\_\+chain()}{set\_nose\_hoover\_chain()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::set\+\_\+nose\+\_\+hoover\+\_\+chain (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1nose__hoover__chain}{nose\+\_\+hoover\+\_\+chain}})}]{nhc,  }\item[{real}]{temp,  }\item[{real}]{q1,  }\item[{integer}]{l }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 182


\begin{DoxyCode}
182     \textcolor{keywordtype}{type}(nose\_hoover\_chain):: nhc
183     \textcolor{keywordtype}{integer}:: l,i
184     \textcolor{keywordtype}{real}::  q1,temp
185 
186     nhc%L = l
187     nhc%temperature = temp
188     nhc%q(1) = q1
189     \textcolor{keywordflow}{do} i=2,nhc%M,1
190         nhc%q(i) = nhc%q(1)/(3.d0*nhc%L)
191 \textcolor{keywordflow}{    enddo}
192 
193     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__integrators_afaf5cf45b5c0a8363d40dc012c954a1a}\label{namespacemd__integrators_afaf5cf45b5c0a8363d40dc012c954a1a}} 
\index{md\+\_\+integrators@{md\+\_\+integrators}!zero\+\_\+forces@{zero\+\_\+forces}}
\index{zero\+\_\+forces@{zero\+\_\+forces}!md\+\_\+integrators@{md\+\_\+integrators}}
\subsubsection{\texorpdfstring{zero\+\_\+forces()}{zero\_forces()}}
{\footnotesize\ttfamily subroutine md\+\_\+integrators\+::zero\+\_\+forces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+integrators.\+f90 строка 148


\begin{DoxyCode}
148     \textcolor{keywordtype}{type}(particles)::   atoms
149     \textcolor{keywordtype}{type}(particle\_group):: group
150     \textcolor{keywordtype}{integer}:: i,ind,k
151 
152     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,ind,k)}
153     \textcolor{comment}{!$OMP DO}
154     \textcolor{keywordflow}{do} ind=1,group%N
155         i = group%indexes(ind)
156         \textcolor{keywordflow}{do} k=1,3
157             atoms%forces(k,i) = 0.
158 \textcolor{keywordflow}{        enddo}
159 \textcolor{keywordflow}{    enddo}
160     \textcolor{comment}{!$OMP END DO}
161     \textcolor{comment}{!$OMP END PARALLEL}
162     
\end{DoxyCode}
