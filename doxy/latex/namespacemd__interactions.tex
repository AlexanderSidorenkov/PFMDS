\hypertarget{namespacemd__interactions}{}\section{Модуль md\+\_\+interactions}
\label{namespacemd__interactions}\index{md\+\_\+interactions@{md\+\_\+interactions}}
\subsection*{Типы данных}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}
\item 
type \mbox{\hyperlink{structmd__interactions_1_1interaction__parameters}{interaction\+\_\+parameters}}
\end{DoxyCompactItemize}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a52c7d3a0c8df2f15b75c8fef73ee795d}{create\+\_\+groups}} (groups, file\+\_\+id, out\+\_\+id, atoms)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_ad655aab8b55d15d13e66769ae95ca229}{create\+\_\+interactions}} (interactions, groups, file\+\_\+id, out\+\_\+id, input\+\_\+path)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a311e6b53338f1b89611eec1929a6387e}{update\+\_\+interactions\+\_\+neighbour\+\_\+lists}} (md\+\_\+step, interactions, atoms, groups, cell, exe\+\_\+time\+\_\+nlsearch, exe\+\_\+time\+\_\+nldistance)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_aba3551fb4bd5364e9cbcfbe81dd6aca9}{allocate\+\_\+graphene\+\_\+norm}} (interactions)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a0f767aead142dc9f1f692172a21a590a}{update\+\_\+norm\+\_\+in\+\_\+graphene}} (interactions)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a851acddc07bbaa6d08cf33c60a9e6822}{calculate\+\_\+forces}} (atoms, interactions)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a5b3213ff25495c56eeabce8427fb3082}{energy}} (inter\+\_\+name, e, nl, p)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a846dbc2db901133c72ff58afb321e918}{calculate\+\_\+potential\+\_\+energies}} (interactions)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a49c070421fed83b68f06a9b8b7f92048}{calculate\+\_\+forces\+\_\+numerically}} (atoms, interactions)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_aac3f945d504b95d25098bb5d5d5f4208}{create\+\_\+truncated\+\_\+nl}} (tnl, nl)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a36f14223ced172ec4c9a9bc381384b55}{destroy\+\_\+truncated\+\_\+nl}} (tnl)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_abc7ac3a3b1e9382804836d43cdc9a224}{calculate\+\_\+truncated\+\_\+nl}} (tnl, nl, i, n)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a4cbfd0c1d189320866efb63454722170}{shift\+\_\+drs}} (tnl, inl, k, nl\+\_\+n, dx)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a2c4725fefbad36399f5de45a222b5d4e}{shift\+\_\+gr\+\_\+norm}} (gr\+\_\+norm, nl\+\_\+nn, inl, k, dx)
\item 
subroutine \mbox{\hyperlink{namespacemd__interactions_a5787116d9c766f3d3ec6355c299d58c2}{nlists\+\_\+load}} (out\+\_\+id, interactions)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacemd__interactions_aba3551fb4bd5364e9cbcfbe81dd6aca9}\label{namespacemd__interactions_aba3551fb4bd5364e9cbcfbe81dd6aca9}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!allocate\+\_\+graphene\+\_\+norm@{allocate\+\_\+graphene\+\_\+norm}}
\index{allocate\+\_\+graphene\+\_\+norm@{allocate\+\_\+graphene\+\_\+norm}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{allocate\+\_\+graphene\+\_\+norm()}{allocate\_graphene\_norm()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::allocate\+\_\+graphene\+\_\+norm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 181


\begin{DoxyCode}
181     \textcolor{keywordtype}{type}(interaction):: interactions(:)
182     \textcolor{keywordtype}{integer}:: i
183     
184     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
185         \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
186         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'})
187             \textcolor{keyword}{allocate}(interactions(i)%parameters%LJC(1)%gr\_norm(3,interactions(i)%nl(3)%N))
188         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'morsec'})
189             \textcolor{keyword}{allocate}(interactions(i)%parameters%MorseC(1)%gr\_norm(3,interactions(i)%nl(3)%N))
190 \textcolor{keywordflow}{        end select}
191 \textcolor{keywordflow}{    enddo}
192     
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a851acddc07bbaa6d08cf33c60a9e6822}\label{namespacemd__interactions_a851acddc07bbaa6d08cf33c60a9e6822}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!calculate\+\_\+forces@{calculate\+\_\+forces}}
\index{calculate\+\_\+forces@{calculate\+\_\+forces}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{calculate\+\_\+forces()}{calculate\_forces()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::calculate\+\_\+forces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 211


\begin{DoxyCode}
211     \textcolor{keywordtype}{type}(interaction):: interactions(:)
212     \textcolor{keywordtype}{type}(particles):: atoms
213     \textcolor{keywordtype}{integer}:: i 
214         
215     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
216         \textcolor{keywordflow}{if}(.not. interactions(i)%numerical\_force) \textcolor{keywordflow}{then}
217             \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
218             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj'})
219                 \textcolor{keyword}{call }lj\_forces(atoms,interactions(i)%nl(1),interactions(i)%parameters%LJ(1))
220                 \textcolor{keyword}{call }lj\_forces(atoms,interactions(i)%nl(2),interactions(i)%parameters%LJ(1))
221             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj1g'})
222                 \textcolor{keyword}{call }lj1g\_forces(atoms,interactions(i)%nl(1),interactions(i)%parameters%LJ1g(1))
223             \textcolor{comment}{!case('morse')}
224             \textcolor{comment}{!   call Morse\_forces(atoms,interactions(i)%nl(1),interactions(i)%parameters%Morse(1))}
225             \textcolor{comment}{!   call Morse\_forces(atoms,interactions(i)%nl(2),interactions(i)%parameters%Morse(1))}
226             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'})
227                 \textcolor{keyword}{call }ljc\_forces\_for\_graphene(atoms,interactions(i)%nl(1),interactions(i)%nl(3),interactions
      (i)%parameters%LJC(1))
228                 \textcolor{keyword}{call }ljc\_forces\_for\_other\_atoms(atoms,interactions(i)%nl(2),interactions(i)%parameters%LJC(
      1))
229             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'morsec'})
230                 \textcolor{keyword}{call }morsec\_forces\_for\_graphene(atoms,interactions(i)%nl(1),interactions(i)%nl(3),
      interactions(i)%parameters%MorseC(1))
231                 \textcolor{keyword}{call }morsec\_forces\_for\_other\_atoms(atoms,interactions(i)%nl(2),interactions(i)%parameters
      %MorseC(1))
232             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'tb'})
233                 \textcolor{keyword}{call }tb\_forces(atoms,interactions(i)%nl(1),interactions(i)%parameters%TB(1))
234             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rebosc'})
235             \textcolor{comment}{!   }
236             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rjl'})
237                 \textcolor{keyword}{call }rjl\_forces(atoms,interactions(i)%nl(1),interactions(i)%parameters%RJL(1))
238 \textcolor{keywordflow}{            end select}
239 \textcolor{keywordflow}{        endif}
240 \textcolor{keywordflow}{    enddo}
241     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_a851acddc07bbaa6d08cf33c60a9e6822_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_a49c070421fed83b68f06a9b8b7f92048}\label{namespacemd__interactions_a49c070421fed83b68f06a9b8b7f92048}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!calculate\+\_\+forces\+\_\+numerically@{calculate\+\_\+forces\+\_\+numerically}}
\index{calculate\+\_\+forces\+\_\+numerically@{calculate\+\_\+forces\+\_\+numerically}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{calculate\+\_\+forces\+\_\+numerically()}{calculate\_forces\_numerically()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::calculate\+\_\+forces\+\_\+numerically (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 274


\begin{DoxyCode}
274     \textcolor{keywordtype}{type}(interaction):: interactions(:)
275     \textcolor{keywordtype}{type}(particles):: atoms
276     \textcolor{keywordtype}{type}(neighbour\_list):: tnl
277     \textcolor{keywordtype}{real}:: e1,e2
278     \textcolor{keywordtype}{integer}:: i,k,inl,j
279     \textcolor{keywordtype}{real},\textcolor{keywordtype}{parameter}:: dx = 10.**(-6)
280 
281     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
282         \textcolor{keywordflow}{if}(interactions(i)%numerical\_force) \textcolor{keywordflow}{then}
283             \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
284             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'},\textcolor{stringliteral}{'morsec'})\textcolor{comment}{!nl(1) - calc\_tnl(0),add nearest neibls,shift\_nl,shift\_gr\_norm !nl(2) -
       calc\_tnl(0),shift\_nl}
285             \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj'},\textcolor{stringliteral}{'morse'},\textcolor{stringliteral}{'tb'},\textcolor{stringliteral}{'rebosc'},\textcolor{stringliteral}{'rjl'})
286                 \textcolor{keywordflow}{do} j=1,interactions(i)%nl\_n
287                     \textcolor{comment}{!$OMP PARALLEL firstprivate(k,inl,e1,e2) private(tnl)}
288                     \textcolor{keyword}{call }create\_truncated\_nl(tnl,interactions(i)%nl(j))
289                     \textcolor{comment}{!$OMP DO}
290                     \textcolor{keywordflow}{do} inl=1,interactions(i)%nl(j)%N
291                         \textcolor{keyword}{call }calculate\_truncated\_nl(tnl,interactions(i)%nl(j),inl,interactions(i)
      %neib\_order)
292                         \textcolor{keywordflow}{do} k=1,3
293                             \textcolor{keyword}{call }shift\_drs(tnl,inl,k,interactions(i)%nl\_n,-dx)
294                             \textcolor{keyword}{call }energy(interactions(i)%interaction\_name,e1,tnl,interactions(i)%parameters)
295                             \textcolor{keyword}{call }shift\_drs(tnl,inl,k,interactions(i)%nl\_n,2*dx)
296                             \textcolor{keyword}{call }energy(interactions(i)%interaction\_name,e2,tnl,interactions(i)%parameters)
297                             \textcolor{keywordflow}{if}(k/=3) \textcolor{keyword}{call }shift\_drs(tnl,inl,k,interactions(i)%nl\_n,-dx)
298                             atoms%forces(k,interactions(i)%nl(j)%particle\_index(inl)) =&
299                             atoms%forces(k,interactions(i)%nl(j)%particle\_index(inl))+(e1-e2)/2/dx
300 \textcolor{keywordflow}{                        enddo}
301 \textcolor{keywordflow}{                    enddo}
302                     \textcolor{comment}{!$OMP END DO}
303                     \textcolor{keyword}{call }destroy\_truncated\_nl(tnl)
304                     \textcolor{comment}{!$OMP END PARALLEL}
305 \textcolor{keywordflow}{                enddo}
306 \textcolor{keywordflow}{            end select}
307 \textcolor{keywordflow}{        endif}
308 \textcolor{keywordflow}{    enddo}
309     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_a49c070421fed83b68f06a9b8b7f92048_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_a846dbc2db901133c72ff58afb321e918}\label{namespacemd__interactions_a846dbc2db901133c72ff58afb321e918}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!calculate\+\_\+potential\+\_\+energies@{calculate\+\_\+potential\+\_\+energies}}
\index{calculate\+\_\+potential\+\_\+energies@{calculate\+\_\+potential\+\_\+energies}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{calculate\+\_\+potential\+\_\+energies()}{calculate\_potential\_energies()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::calculate\+\_\+potential\+\_\+energies (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 264


\begin{DoxyCode}
264     \textcolor{keywordtype}{type}(interaction):: interactions(:)
265     \textcolor{keywordtype}{integer}:: i
266     
267     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
268         \textcolor{keyword}{call }energy(interactions(i)%interaction\_name,interactions(i)%energy,interactions(i)%nl(1),
      interactions(i)%parameters)
269 \textcolor{keywordflow}{    enddo}
270         
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_a846dbc2db901133c72ff58afb321e918_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_abc7ac3a3b1e9382804836d43cdc9a224}\label{namespacemd__interactions_abc7ac3a3b1e9382804836d43cdc9a224}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!calculate\+\_\+truncated\+\_\+nl@{calculate\+\_\+truncated\+\_\+nl}}
\index{calculate\+\_\+truncated\+\_\+nl@{calculate\+\_\+truncated\+\_\+nl}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{calculate\+\_\+truncated\+\_\+nl()}{calculate\_truncated\_nl()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::calculate\+\_\+truncated\+\_\+nl (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{tnl,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{integer}]{i,  }\item[{integer}]{n }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 335


\begin{DoxyCode}
335     \textcolor{keywordtype}{type}(neighbour\_list):: tnl,nl
336     \textcolor{keywordtype}{integer}:: n,i,ni,p,q,j
337     
338     tnl%particle\_index = 0; tnl%nnum = 0; \textcolor{comment}{!tnl%nlist = 0!tnl%dr = 0.!tnl%moddr = 0.}
339     
340     tnl%N = nl%N
341     tnl%neighb\_num\_max = nl%neighb\_num\_max
342     tnl%nlist(:nl%nnum(i),i) = nl%nlist(:nl%nnum(i),i)
343     tnl%dr(:,:nl%nnum(i),i) = nl%dr(:,:nl%nnum(i),i)
344     tnl%moddr(:nl%nnum(i),i) = nl%moddr(:nl%nnum(i),i)
345     tnl%nnum(i) = nl%nnum(i)
346     tnl%particle\_index(i) = nl%particle\_index(i)
347     \textcolor{keywordflow}{do} ni=1,n
348         \textcolor{keywordflow}{if}(ni<n) \textcolor{keywordflow}{then}
349             \textcolor{keywordflow}{do} j=1,tnl%N
350                 \textcolor{keywordflow}{do} p=1,tnl%nnum(j)
351                     q = tnl%nlist(p,j)
352                     \textcolor{keywordflow}{if}(tnl%nnum(q)==0) \textcolor{keywordflow}{then}
353                         tnl%nlist(:nl%nnum(q),q) = nl%nlist(:nl%nnum(q),q)
354                         tnl%dr(:,:nl%nnum(q),q) = nl%dr(:,:nl%nnum(q),q)
355                         tnl%moddr(:nl%nnum(q),q) = nl%moddr(:nl%nnum(q),q)
356                         tnl%particle\_index(q) = nl%particle\_index(q)
357 \textcolor{keywordflow}{                    endif}
358 \textcolor{keywordflow}{                enddo}
359 \textcolor{keywordflow}{            enddo}
360             \textcolor{keywordflow}{do} j=1,tnl%N
361                 \textcolor{keywordflow}{if}(tnl%particle\_index(j)/=0) tnl%nnum(j) = nl%nnum(j)
362 \textcolor{keywordflow}{            enddo}
363         \textcolor{keywordflow}{else}
364             \textcolor{keywordflow}{do} j=1,tnl%N
365                 \textcolor{keywordflow}{do} p=1,tnl%nnum(j)
366                     q = tnl%nlist(p,j)
367                     \textcolor{keywordflow}{if}(tnl%nnum(q)==0) \textcolor{keywordflow}{then}
368                         tnl%nnum(q) = tnl%nnum(q)+1
369                         tnl%nlist(tnl%nnum(q),q) = j
370                         tnl%dr(:,tnl%nnum(q),q) = -nl%dr(:,p,j)
371                         tnl%moddr(tnl%nnum(q),q) = nl%moddr(p,j)
372                         tnl%particle\_index(q) = nl%particle\_index(q)
373 \textcolor{keywordflow}{                    endif}
374 \textcolor{keywordflow}{                enddo}
375 \textcolor{keywordflow}{            enddo}
376 \textcolor{keywordflow}{        endif}
377 \textcolor{keywordflow}{    enddo}
378     
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a52c7d3a0c8df2f15b75c8fef73ee795d}\label{namespacemd__interactions_a52c7d3a0c8df2f15b75c8fef73ee795d}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!create\+\_\+groups@{create\+\_\+groups}}
\index{create\+\_\+groups@{create\+\_\+groups}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{create\+\_\+groups()}{create\_groups()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::create\+\_\+groups (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}}), dimension(\+:), allocatable}]{groups,  }\item[{integer}]{file\+\_\+id,  }\item[{integer}]{out\+\_\+id,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 39


\begin{DoxyCode}
39     \textcolor{keywordtype}{type}(particle\_group),\textcolor{keywordtype}{allocatable}:: groups(:)
40     \textcolor{keywordtype}{type}(particles):: atoms
41     \textcolor{keywordtype}{character(len=32)},\textcolor{keywordtype}{allocatable}:: type\_names(:,:)
42     \textcolor{keywordtype}{character(len=128)}:: str,frmt
43     \textcolor{keywordtype}{integer}:: i,particle\_types\_num,groups\_num,file\_id,out\_id
44     
45     \textcolor{keyword}{read}(file\_id,*) str,particle\_types\_num
46     \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A32,i12)'}) str,particle\_types\_num
47     \textcolor{keyword}{read}(file\_id,*) str,groups\_num
48     \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A32,i12)'}) str,groups\_num
49     \textcolor{keyword}{allocate}(groups(groups\_num),type\_names(particle\_types\_num,groups\_num))
50     \textcolor{keyword}{write}(frmt,\textcolor{stringliteral}{'("(i6,A,",i0,"A12,i9)")'}) particle\_types\_num
51     \textcolor{keywordflow}{do} i=1,groups\_num
52         \textcolor{keyword}{read}(file\_id,*) str,type\_names(:,i)
53         \textcolor{keyword}{call }create\_particle\_group(groups(i),type\_names(:,i),atoms)
54         \textcolor{keyword}{write}(out\_id,frmt) i,\textcolor{stringliteral}{' '},type\_names(:,i),groups(i)%N
55 \textcolor{keywordflow}{    enddo}
56     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespacemd__interactions_a52c7d3a0c8df2f15b75c8fef73ee795d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_ad655aab8b55d15d13e66769ae95ca229}\label{namespacemd__interactions_ad655aab8b55d15d13e66769ae95ca229}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!create\+\_\+interactions@{create\+\_\+interactions}}
\index{create\+\_\+interactions@{create\+\_\+interactions}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{create\+\_\+interactions()}{create\_interactions()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::create\+\_\+interactions (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:), allocatable}]{interactions,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}}), dimension(\+:)}]{groups,  }\item[{integer}]{file\+\_\+id,  }\item[{integer}]{out\+\_\+id,  }\item[{character(len=128)}]{input\+\_\+path }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 60


\begin{DoxyCode}
60     \textcolor{keywordtype}{type}(interaction),\textcolor{keywordtype}{allocatable}:: interactions(:)
61     \textcolor{keywordtype}{type}(particle\_group):: groups(:)
62     \textcolor{keywordtype}{integer}:: file\_id,out\_id,i,j,inter\_n
63     \textcolor{keywordtype}{character(len=128)}:: input\_path,str
64     
65     \textcolor{keyword}{read}(file\_id,*) str,inter\_n
66     \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A32,i12)'}) str,inter\_n
67     \textcolor{keyword}{allocate}(interactions(inter\_n))
68     \textcolor{keywordflow}{do} i=1,inter\_n
69         \textcolor{keyword}{read}(file\_id,*) interactions(i)%interaction\_name,interactions(i)%parameters\_file
70         \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
71         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj'})
72             \textcolor{keyword}{allocate}(interactions(i)%parameters%LJ(1))
73             \textcolor{keyword}{call }read\_lj\_parameters(interactions(i)%parameters%LJ(1),trim(input\_path)//interactions(i)
      %parameters\_file)
74             interactions(i)%nl\_n = 2
75             interactions(i)%neib\_order = 0
76             interactions(i)%numerical\_force = .false.
77         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj1g'})
78             \textcolor{keyword}{allocate}(interactions(i)%parameters%LJ1g(1))
79             \textcolor{keyword}{call }read\_lj1g\_parameters(interactions(i)%parameters%LJ1g(1),trim(input\_path)//interactions(i)
      %parameters\_file)
80             interactions(i)%nl\_n = 1
81             interactions(i)%neib\_order = 0
82             interactions(i)%numerical\_force = .false.
83         \textcolor{comment}{!case('morse')}
84         \textcolor{comment}{!   allocate(interactions(i)%parameters%Morse(1))}
85         \textcolor{comment}{!   call
       read\_Morse\_parameters(interactions(i)%parameters%Morse(1),trim(input\_path)//interactions(i)%parameters\_file)}
86         \textcolor{comment}{!   interactions(i)%nl\_n = 2}
87         \textcolor{comment}{!   interactions(i)%neib\_order = 0}
88         \textcolor{comment}{!   interactions(i)%numerical\_force = .false.}
89         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'})
90             \textcolor{keyword}{allocate}(interactions(i)%parameters%LJC(1))
91             \textcolor{keyword}{call }read\_ljc\_parameters(interactions(i)%parameters%LJC(1),trim(input\_path)//interactions(i)
      %parameters\_file)
92             interactions(i)%nl\_n = 3
93             interactions(i)%neib\_order = 0
94             interactions(i)%numerical\_force = .false.
95         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'morsec'})
96             \textcolor{keyword}{allocate}(interactions(i)%parameters%MorseC(1))
97             \textcolor{keyword}{call }read\_morsec\_parameters(interactions(i)%parameters%MorseC(1),trim(input\_path)//interactions
      (i)%parameters\_file)
98             interactions(i)%nl\_n = 3
99             interactions(i)%neib\_order = 0
100             interactions(i)%numerical\_force = .false.
101         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'tb'})
102             \textcolor{keyword}{allocate}(interactions(i)%parameters%TB(1))
103             \textcolor{keyword}{call }read\_tb\_parameters(interactions(i)%parameters%TB(1),trim(input\_path)//interactions(i)
      %parameters\_file)
104             interactions(i)%nl\_n = 1
105             interactions(i)%neib\_order = 2
106             interactions(i)%numerical\_force = .false.
107         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rebosc'})
108             \textcolor{keyword}{allocate}(interactions(i)%parameters%REBOsc(1))
109             \textcolor{keyword}{call }read\_rebosc\_parameters(interactions(i)%parameters%REBOsc(1),trim(input\_path)//interactions
      (i)%parameters\_file)
110             interactions(i)%nl\_n = 1
111             interactions(i)%neib\_order = 3
112             interactions(i)%numerical\_force = .true.            
113         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rjl'})
114             \textcolor{keyword}{allocate}(interactions(i)%parameters%RJL(1))
115             \textcolor{keyword}{call }read\_rjl\_parameters(interactions(i)%parameters%RJL(1),trim(input\_path)//interactions(i)
      %parameters\_file)
116             interactions(i)%nl\_n = 1
117             interactions(i)%neib\_order = 2
118             interactions(i)%numerical\_force = .false.
119 \textcolor{keywordflow}{        case default}
120             print*,\textcolor{stringliteral}{'error: unknown interaction name'}
121 \textcolor{keywordflow}{        end select}
122         \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(2A32,i6)'}) interactions(i)%interaction\_name,interactions(i)%parameters\_file,
      interactions(i)%nl\_n
123         \textcolor{keyword}{allocate}(interactions(i)%group\_nums(2*interactions(i)%nl\_n))
124         \textcolor{keyword}{allocate}(interactions(i)%nl(interactions(i)%nl\_n))
125         \textcolor{keywordflow}{do} j=1,interactions(i)%nl\_n
126             \textcolor{keyword}{read}(file\_id,*) interactions(i)%group\_nums(j*2-1:j*2),&
127             interactions(i)%nl(j)%neighb\_num\_max,interactions(i)%nl(j)%r\_cut,interactions(i)%nl(j)
      %update\_period
128             \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(3i6,f16.6,i9)'}) interactions(i)%group\_nums(j*2-1:j*2),&
129             interactions(i)%nl(j)%neighb\_num\_max,interactions(i)%nl(j)%r\_cut,interactions(i)%nl(j)
      %update\_period
130             interactions(i)%nl(j)%N = groups(interactions(i)%group\_nums(j*2-1))%N
131             \textcolor{keyword}{call }create\_neighbour\_list(interactions(i)%nl(j))
132 \textcolor{keywordflow}{        enddo}
133 \textcolor{keywordflow}{    enddo}
134     \textcolor{keyword}{call }allocate\_graphene\_norm(interactions)
135     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_ad655aab8b55d15d13e66769ae95ca229_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_aac3f945d504b95d25098bb5d5d5f4208}\label{namespacemd__interactions_aac3f945d504b95d25098bb5d5d5f4208}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!create\+\_\+truncated\+\_\+nl@{create\+\_\+truncated\+\_\+nl}}
\index{create\+\_\+truncated\+\_\+nl@{create\+\_\+truncated\+\_\+nl}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{create\+\_\+truncated\+\_\+nl()}{create\_truncated\_nl()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::create\+\_\+truncated\+\_\+nl (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{tnl,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 313


\begin{DoxyCode}
313     \textcolor{keywordtype}{type}(neighbour\_list):: tnl,nl
314     
315     tnl%N = nl%N
316     tnl%neighb\_num\_max = nl%neighb\_num\_max
317     \textcolor{keyword}{call }create\_neighbour\_list(tnl)
318     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_aac3f945d504b95d25098bb5d5d5f4208_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_a36f14223ced172ec4c9a9bc381384b55}\label{namespacemd__interactions_a36f14223ced172ec4c9a9bc381384b55}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!destroy\+\_\+truncated\+\_\+nl@{destroy\+\_\+truncated\+\_\+nl}}
\index{destroy\+\_\+truncated\+\_\+nl@{destroy\+\_\+truncated\+\_\+nl}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{destroy\+\_\+truncated\+\_\+nl()}{destroy\_truncated\_nl()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::destroy\+\_\+truncated\+\_\+nl (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{tnl }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 322


\begin{DoxyCode}
322     \textcolor{keywordtype}{type}(neighbour\_list):: tnl
323     
324     tnl%N = 0
325     tnl%neighb\_num\_max = 0
326     \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}(tnl%particle\_index)) \textcolor{keyword}{deallocate}(tnl%particle\_index)
327     \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}(tnl%nnum)) \textcolor{keyword}{deallocate}(tnl%nnum)
328     \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}(tnl%nlist)) \textcolor{keyword}{deallocate}(tnl%nlist)
329     \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}(tnl%dr)) \textcolor{keyword}{deallocate}(tnl%dr)
330     \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}(tnl%moddr)) \textcolor{keyword}{deallocate}(tnl%moddr)
331     
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a5b3213ff25495c56eeabce8427fb3082}\label{namespacemd__interactions_a5b3213ff25495c56eeabce8427fb3082}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!energy@{energy}}
\index{energy@{energy}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{energy()}{energy()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::energy (\begin{DoxyParamCaption}\item[{character(len=32)}]{inter\+\_\+name,  }\item[{real}]{e,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction__parameters}{interaction\+\_\+parameters}})}]{p }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 245


\begin{DoxyCode}
245     \textcolor{keywordtype}{type}(interaction\_parameters):: p
246     \textcolor{keywordtype}{type}(neighbour\_list):: nl
247     \textcolor{keywordtype}{character(len=32)}:: inter\_name
248     \textcolor{keywordtype}{real}:: e
249     
250     \textcolor{keywordflow}{select case} (inter\_name)
251     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj'});     \textcolor{keyword}{call }lj\_energy(e,nl,p%LJ(1))
252     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj1g'});   \textcolor{keyword}{call }lj1g\_energy(e,nl,p%LJ1g(1))
253     \textcolor{comment}{!case('morse');}
254     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'});    \textcolor{keyword}{call }ljc\_energy(e,nl,p%LJC(1))
255     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'morsec'}); \textcolor{keyword}{call }morsec\_energy(e,nl,p%MorseC(1))
256     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'tb'});     \textcolor{keyword}{call }tb\_energy(e,nl,p%TB(1))
257     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rebosc'}); \textcolor{keyword}{call }rebosc\_energy(e,nl,p%REBOsc(1))
258     \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rjl'});    \textcolor{keyword}{call }rjl\_energy(e,nl,p%RJL(1))
259 \textcolor{keywordflow}{    end select}
260     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_a5b3213ff25495c56eeabce8427fb3082_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_a5787116d9c766f3d3ec6355c299d58c2}\label{namespacemd__interactions_a5787116d9c766f3d3ec6355c299d58c2}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!nlists\+\_\+load@{nlists\+\_\+load}}
\index{nlists\+\_\+load@{nlists\+\_\+load}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{nlists\+\_\+load()}{nlists\_load()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::nlists\+\_\+load (\begin{DoxyParamCaption}\item[{integer}]{out\+\_\+id,  }\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 428


\begin{DoxyCode}
428     \textcolor{keywordtype}{type}(interaction):: interactions(:)
429     \textcolor{keywordtype}{integer}:: i,j,out\_id
430     
431     \textcolor{keywordflow}{if}(\textcolor{keyword}{size}(interactions)>0) \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A)'}) \textcolor{stringliteral}{' neib lists load:'}     
432     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
433         \textcolor{keywordflow}{do} j=1,interactions(i)%nl\_n
434             \textcolor{keywordflow}{if}(interactions(i)%nl(j)%N>0) \textcolor{keywordflow}{then}
435                 \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A12,i6,i6,A,i6)'}) trim(interactions(i)%interaction\_name),j,&
436                 maxval(interactions(i)%nl(j)%nnum),\textcolor{stringliteral}{'/'},interactions(i)%nl(j)%neighb\_num\_max
437             \textcolor{keywordflow}{else}
438                 \textcolor{keyword}{write}(out\_id,\textcolor{stringliteral}{'(A12,i6,i6,A,i6)'}) trim(interactions(i)%interaction\_name),j,&
439                 0,\textcolor{stringliteral}{'/'},interactions(i)%nl(j)%neighb\_num\_max
440 \textcolor{keywordflow}{            endif}
441 \textcolor{keywordflow}{        enddo}
442 \textcolor{keywordflow}{    enddo}
443     
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a4cbfd0c1d189320866efb63454722170}\label{namespacemd__interactions_a4cbfd0c1d189320866efb63454722170}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!shift\+\_\+drs@{shift\+\_\+drs}}
\index{shift\+\_\+drs@{shift\+\_\+drs}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{shift\+\_\+drs()}{shift\_drs()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::shift\+\_\+drs (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{tnl,  }\item[{integer}]{inl,  }\item[{integer}]{k,  }\item[{integer}]{nl\+\_\+n,  }\item[{real}]{dx }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 382


\begin{DoxyCode}
382     \textcolor{keywordtype}{type}(neighbour\_list):: tnl
383     \textcolor{keywordtype}{real}:: dx
384     \textcolor{keywordtype}{integer}:: p,k,inl,q,j,nl\_n
385     
386     \textcolor{keywordflow}{do} p=1,tnl%nnum(inl)
387         tnl%dr(k,p,inl) = tnl%dr(k,p,inl)-dx
388         tnl%moddr(p,inl) = sqrt(sum(tnl%dr(:,p,inl)**2))
389 \textcolor{keywordflow}{    enddo}
390     \textcolor{keywordflow}{if}(nl\_n==1) \textcolor{keywordflow}{then}
391         \textcolor{keywordflow}{do} j=1,tnl%N
392             \textcolor{keywordflow}{do} p=1,tnl%nnum(j)
393                 q = tnl%nlist(p,j)
394                 \textcolor{keywordflow}{if}(q==inl) \textcolor{keywordflow}{then}
395                     tnl%dr(k,p,j) = tnl%dr(k,p,j)+dx
396                     tnl%moddr(p,j) = sqrt(sum(tnl%dr(:,p,j)**2))
397 \textcolor{keywordflow}{                endif}
398 \textcolor{keywordflow}{            enddo}
399 \textcolor{keywordflow}{        enddo}
400 \textcolor{keywordflow}{    endif}
401 
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a2c4725fefbad36399f5de45a222b5d4e}\label{namespacemd__interactions_a2c4725fefbad36399f5de45a222b5d4e}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!shift\+\_\+gr\+\_\+norm@{shift\+\_\+gr\+\_\+norm}}
\index{shift\+\_\+gr\+\_\+norm@{shift\+\_\+gr\+\_\+norm}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{shift\+\_\+gr\+\_\+norm()}{shift\_gr\_norm()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::shift\+\_\+gr\+\_\+norm (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:)}]{gr\+\_\+norm,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl\+\_\+nn,  }\item[{integer}]{inl,  }\item[{integer}]{k,  }\item[{real}]{dx }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 405


\begin{DoxyCode}
405     \textcolor{keywordtype}{real}:: gr\_norm(:,:)
406     \textcolor{keywordtype}{type}(neighbour\_list):: nl\_nn
407     \textcolor{keywordtype}{real}:: dx,drj12(3),drj31(3)
408     \textcolor{keywordtype}{integer}:: k,inl,p,q,j,l
409     
410     \textcolor{keywordflow}{do} p=1,nl\_nn%nnum(inl)
411         j = nl\_nn%nlist(p,inl)
412         \textcolor{keywordflow}{do} q=1,nl\_nn%nnum(j)
413             \textcolor{keywordflow}{if}(nl\_nn%nlist(q,j)==inl) \textcolor{keywordflow}{exit}
414 \textcolor{keywordflow}{        enddo}   
415         drj12 = nl\_nn%dr(:,mod(q+1,3)+1,j)-nl\_nn%dr(:,mod(q,3)+1,j)
416         drj31 = nl\_nn%dr(:,mod(q,3)+1,j)-nl\_nn%dr(:,q,j)
417         drj31(k) = drj31(k)+dx
418         \textcolor{keywordflow}{do} l=1,3
419             gr\_norm(l,j) = (drj12(mod(l,3)+1))*(drj31(mod(l+1,3)+1))-(drj12(mod(l+1,3)+1))*(drj31(mod(l,3)+
      1))
420 \textcolor{keywordflow}{        enddo}
421         \textcolor{keywordflow}{if} (gr\_norm(3,j)<0.) gr\_norm(:,j)=-gr\_norm(:,j)
422         gr\_norm(:,j) = gr\_norm(:,j)/sqrt(sum(gr\_norm(:,j)**2))
423 \textcolor{keywordflow}{    enddo}
424     
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__interactions_a311e6b53338f1b89611eec1929a6387e}\label{namespacemd__interactions_a311e6b53338f1b89611eec1929a6387e}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!update\+\_\+interactions\+\_\+neighbour\+\_\+lists@{update\+\_\+interactions\+\_\+neighbour\+\_\+lists}}
\index{update\+\_\+interactions\+\_\+neighbour\+\_\+lists@{update\+\_\+interactions\+\_\+neighbour\+\_\+lists}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{update\+\_\+interactions\+\_\+neighbour\+\_\+lists()}{update\_interactions\_neighbour\_lists()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::update\+\_\+interactions\+\_\+neighbour\+\_\+lists (\begin{DoxyParamCaption}\item[{integer}]{md\+\_\+step,  }\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}}), dimension(\+:)}]{groups,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{cell,  }\item[{real}]{exe\+\_\+time\+\_\+nlsearch,  }\item[{real}]{exe\+\_\+time\+\_\+nldistance }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 139


\begin{DoxyCode}
139     \textcolor{keywordtype}{type}(interaction):: interactions(:)
140     \textcolor{keywordtype}{type}(particles):: atoms
141     \textcolor{keywordtype}{type}(particle\_group):: groups(:)
142     \textcolor{keywordtype}{type}(simulation\_cell):: cell
143     \textcolor{keywordtype}{integer}:: i,j,md\_step
144     \textcolor{keywordtype}{real}:: exe\_time\_nlsearch,exe\_time\_nldistance
145     
146     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
147     
148         \textcolor{keyword}{call }update\_neighbour\_list(md\_step,interactions(i)%nl(1),atoms,&
149         groups(interactions(i)%group\_nums(1)),groups(interactions(i)%group\_nums(2)),cell,exe\_time\_nlsearch,
      exe\_time\_nldistance)
150         
151         \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
152         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'lj'},\textcolor{stringliteral}{'morse'},\textcolor{stringliteral}{'ljc'},\textcolor{stringliteral}{'morsec'})
153             \textcolor{keyword}{call }converce\_neighbour\_list(interactions(i)%nl(2),&
154             groups(interactions(i)%group\_nums(2)),interactions(i)%nl(1))
155 \textcolor{keywordflow}{        end select}
156         
157         \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
158         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'},\textcolor{stringliteral}{'morsec'})
159             \textcolor{keywordflow}{do} j=1,\textcolor{keyword}{size}(interactions)
160                 \textcolor{keywordflow}{select case} (interactions(j)%interaction\_name)
161                 \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'tb'}); \textcolor{keywordflow}{exit}
162                 \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'rebosc'}); \textcolor{keywordflow}{exit}
163 \textcolor{keywordflow}{                end select}
164 \textcolor{keywordflow}{            enddo}
165             \textcolor{keywordflow}{if} (j<=\textcolor{keyword}{size}(interactions)) \textcolor{keywordflow}{then}
166                 \textcolor{keyword}{call }update\_nearest\_neighbours\_in\_graphene(md\_step,interactions(i)%nl(3),interactions(j)%nl
      (1),atoms,&
167                 groups(interactions(j)%group\_nums(1)),cell)
168             \textcolor{keywordflow}{else}
169                 \textcolor{keyword}{call }update\_neighbour\_list(md\_step,interactions(i)%nl(3),atoms,&
170                 groups(interactions(i)%group\_nums(5)),groups(interactions(i)%group\_nums(6)),cell,
      exe\_time\_nlsearch,exe\_time\_nldistance)
171 \textcolor{keywordflow}{            endif}
172 \textcolor{keywordflow}{        end select}
173         
174 \textcolor{keywordflow}{    enddo}
175     
176     \textcolor{keyword}{call }update\_norm\_in\_graphene(interactions)
177     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemd__interactions_a311e6b53338f1b89611eec1929a6387e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemd__interactions_a0f767aead142dc9f1f692172a21a590a}\label{namespacemd__interactions_a0f767aead142dc9f1f692172a21a590a}} 
\index{md\+\_\+interactions@{md\+\_\+interactions}!update\+\_\+norm\+\_\+in\+\_\+graphene@{update\+\_\+norm\+\_\+in\+\_\+graphene}}
\index{update\+\_\+norm\+\_\+in\+\_\+graphene@{update\+\_\+norm\+\_\+in\+\_\+graphene}!md\+\_\+interactions@{md\+\_\+interactions}}
\subsubsection{\texorpdfstring{update\+\_\+norm\+\_\+in\+\_\+graphene()}{update\_norm\_in\_graphene()}}
{\footnotesize\ttfamily subroutine md\+\_\+interactions\+::update\+\_\+norm\+\_\+in\+\_\+graphene (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__interactions_1_1interaction}{interaction}}), dimension(\+:)}]{interactions }\end{DoxyParamCaption})}



См. определение в файле md\+\_\+interactions.\+f90 строка 196


\begin{DoxyCode}
196     \textcolor{keywordtype}{type}(interaction):: interactions(:)
197     \textcolor{keywordtype}{integer}:: i
198     
199     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(interactions)
200         \textcolor{keywordflow}{select case} (interactions(i)%interaction\_name)
201         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'ljc'})
202             \textcolor{keyword}{call }find\_norm\_in\_graphene(interactions(i)%parameters%LJC(1)%gr\_norm,interactions(i)%nl(3)%dr)
203         \textcolor{keywordflow}{case}(\textcolor{stringliteral}{'morsec'})
204             \textcolor{keyword}{call }find\_norm\_in\_graphene(interactions(i)%parameters%MorseC(1)%gr\_norm,interactions(i)%nl(3)
      %dr)
205 \textcolor{keywordflow}{        end select}
206 \textcolor{keywordflow}{    enddo}
207 
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{namespacemd__interactions_a0f767aead142dc9f1f692172a21a590a_cgraph}
\end{center}
\end{figure}
