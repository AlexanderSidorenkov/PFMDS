\hypertarget{namespacetersoffbrenner}{}\section{Модуль tersoffbrenner}
\label{namespacetersoffbrenner}\index{tersoffbrenner@{tersoffbrenner}}
\subsection*{Типы данных}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structtersoffbrenner_1_1tersoffbrenner__parameters}{tersoffbrenner\+\_\+parameters}}
\end{DoxyCompactItemize}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacetersoffbrenner_a04beb5c27e136d95b3502f15d39d8ef9}{read\+\_\+tb\+\_\+parameters}} (T\+Bp, filename)
\item 
subroutine \mbox{\hyperlink{namespacetersoffbrenner_a273a6849892363697886b1f1d0f8df93}{tb\+\_\+energy}} (energy, nl, T\+Bp)
\item 
subroutine \mbox{\hyperlink{namespacetersoffbrenner_a1edc8ac251b3fa58026839db4d23f12a}{tb\+\_\+forces}} (atoms, nl, T\+Bp)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacetersoffbrenner_a04beb5c27e136d95b3502f15d39d8ef9}\label{namespacetersoffbrenner_a04beb5c27e136d95b3502f15d39d8ef9}} 
\index{tersoffbrenner@{tersoffbrenner}!read\+\_\+tb\+\_\+parameters@{read\+\_\+tb\+\_\+parameters}}
\index{read\+\_\+tb\+\_\+parameters@{read\+\_\+tb\+\_\+parameters}!tersoffbrenner@{tersoffbrenner}}
\subsubsection{\texorpdfstring{read\+\_\+tb\+\_\+parameters()}{read\_tb\_parameters()}}
{\footnotesize\ttfamily subroutine tersoffbrenner\+::read\+\_\+tb\+\_\+parameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structtersoffbrenner_1_1tersoffbrenner__parameters}{tersoffbrenner\+\_\+parameters}})}]{T\+Bp,  }\item[{character($\ast$)}]{filename }\end{DoxyParamCaption})}



См. определение в файле Tersoff\+Brenner.\+f90 строка 14


\begin{DoxyCode}
14     \textcolor{keywordtype}{type}(TersoffBrenner\_parameters):: TBp
15     \textcolor{keywordtype}{character(*)}::  filename
16     
17     \textcolor{keyword}{open}(1,file=filename)
18     \textcolor{keyword}{read}(1,*) tbp%d,tbp%s,tbp%b,tbp%r0,tbp%delt,tbp%a0,tbp%c0,tbp%d0
19     \textcolor{keyword}{read}(1,*) tbp%R1,tbp%R2
20     \textcolor{keyword}{close}(1)
21     tbp%c02 = tbp%c0**2
22     tbp%d02 = tbp%d0**2
23     
\end{DoxyCode}
\mbox{\Hypertarget{namespacetersoffbrenner_a273a6849892363697886b1f1d0f8df93}\label{namespacetersoffbrenner_a273a6849892363697886b1f1d0f8df93}} 
\index{tersoffbrenner@{tersoffbrenner}!tb\+\_\+energy@{tb\+\_\+energy}}
\index{tb\+\_\+energy@{tb\+\_\+energy}!tersoffbrenner@{tersoffbrenner}}
\subsubsection{\texorpdfstring{tb\+\_\+energy()}{tb\_energy()}}
{\footnotesize\ttfamily subroutine tersoffbrenner\+::tb\+\_\+energy (\begin{DoxyParamCaption}\item[{real}]{energy,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structtersoffbrenner_1_1tersoffbrenner__parameters}{tersoffbrenner\+\_\+parameters}})}]{T\+Bp }\end{DoxyParamCaption})}



См. определение в файле Tersoff\+Brenner.\+f90 строка 27


\begin{DoxyCode}
27     \textcolor{keywordtype}{type}(neighbour\_list):: nl
28     \textcolor{keywordtype}{type}(TersoffBrenner\_parameters):: TBp
29     \textcolor{keywordtype}{integer}:: i,p,j,q
30     \textcolor{keywordtype}{real}:: energy,energy\_priv,B(nl%neighb\_num\_max,nl%N),a
31 
32     energy = 0.
33     energy\_priv = 0.
34     \textcolor{comment}{!$OMP PARALLEL firstprivate(energy\_priv,i,p,j,q,a)}
35     \textcolor{comment}{!$OMP DO}
36     \textcolor{keywordflow}{do} i=1,nl%N
37         b(:,i) = 0. \textcolor{comment}{!look rebosc }
38         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
39             \textcolor{comment}{!B(p,i) = 0.}
40             \textcolor{keywordflow}{if} (nl%moddr(p,i)<tbp%R2) \textcolor{keywordflow}{then}
41                 \textcolor{keywordflow}{do} q=1,nl%nnum(i)
42                     \textcolor{keywordflow}{if}(p/=q .AND. nl%moddr(q,i)<tbp%R2) \textcolor{keywordflow}{then}
43                         b(p,i) = b(p,i)+f\_cut(nl%moddr(q,i),tbp%R1,tbp%R2)*&
44                         (1.+tbp%c02/tbp%d02-tbp%c02/(tbp%d02+(1.+sum(nl%dr(:,p,i)*nl%dr(:,q,i))/(nl%moddr(p
      ,i)*nl%moddr(q,i)))**2)) 
45 \textcolor{keywordflow}{                    endif}
46 \textcolor{keywordflow}{                enddo}
47                 b(p,i) = (1.+tbp%a0*b(p,i))**(-tbp%delt)
48 \textcolor{keywordflow}{            endif}
49 \textcolor{keywordflow}{        enddo}
50 \textcolor{keywordflow}{    enddo}
51     \textcolor{comment}{!$OMP END DO    }
52     \textcolor{comment}{!$OMP DO}
53     \textcolor{keywordflow}{do} i=1,nl%N
54         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
55             \textcolor{keywordflow}{if} (nl%moddr(p,i)<tbp%R2) \textcolor{keywordflow}{then}
56                 j = nl%nlist(p,i)
57                 \textcolor{keywordflow}{if} (j>i) \textcolor{keywordflow}{then}
58                     \textcolor{keywordflow}{do} q=1,nl%nnum(j)
59                         \textcolor{keywordflow}{if}(nl%nlist(q,j)==i) \textcolor{keywordflow}{exit}
60 \textcolor{keywordflow}{                    enddo}
61                     a = -sqrt(2.*tbp%s)*tbp%b*(nl%moddr(p,i)-tbp%r0)
62                     energy\_priv = energy\_priv+f\_cut(nl%moddr(p,i),tbp%R1,tbp%R2)*tbp%d/(tbp%s-1.)*(exp(a)-(
      b(p,i)+b(q,j))/2*tbp%s*exp(a/tbp%s))
63 \textcolor{keywordflow}{                endif}
64 \textcolor{keywordflow}{            endif}
65 \textcolor{keywordflow}{        enddo}
66 \textcolor{keywordflow}{    enddo}
67     \textcolor{comment}{!$OMP END DO}
68     \textcolor{comment}{!$OMP ATOMIC}
69         energy = energy+energy\_priv
70     \textcolor{comment}{!$OMP END PARALLEL}
71     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{namespacetersoffbrenner_a273a6849892363697886b1f1d0f8df93_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacetersoffbrenner_a1edc8ac251b3fa58026839db4d23f12a}\label{namespacetersoffbrenner_a1edc8ac251b3fa58026839db4d23f12a}} 
\index{tersoffbrenner@{tersoffbrenner}!tb\+\_\+forces@{tb\+\_\+forces}}
\index{tb\+\_\+forces@{tb\+\_\+forces}!tersoffbrenner@{tersoffbrenner}}
\subsubsection{\texorpdfstring{tb\+\_\+forces()}{tb\_forces()}}
{\footnotesize\ttfamily subroutine tersoffbrenner\+::tb\+\_\+forces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structtersoffbrenner_1_1tersoffbrenner__parameters}{tersoffbrenner\+\_\+parameters}})}]{T\+Bp }\end{DoxyParamCaption})}



См. определение в файле Tersoff\+Brenner.\+f90 строка 75


\begin{DoxyCode}
75     \textcolor{keywordtype}{type}(particles)::   atoms
76     \textcolor{keywordtype}{type}(neighbour\_list):: nl
77     \textcolor{keywordtype}{type}(TersoffBrenner\_parameters):: TBp
78     \textcolor{keywordtype}{integer}:: i,p,j,q,l
79     \textcolor{keywordtype}{real}:: B(nl%neighb\_num\_max,nl%N),dB(3),a,dff,rr,cosi,f\_c,df\_c
80     
81     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,p,j,q,l,a,dff,rr,cosi,f\_c,df\_c,dB)}
82     \textcolor{comment}{!$OMP DO}
83     \textcolor{keywordflow}{do} i=1,nl%N
84         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
85             b(p,i) = 0.
86             \textcolor{keywordflow}{if} (nl%moddr(p,i)<tbp%R2) \textcolor{keywordflow}{then}
87                 \textcolor{keywordflow}{do} q=1,nl%nnum(i)
88                     \textcolor{keywordflow}{if}(p/=q .AND. nl%moddr(q,i)<tbp%R2) \textcolor{keywordflow}{then}
89                         b(p,i) = b(p,i)+f\_cut(nl%moddr(q,i),tbp%R1,tbp%R2)*&
90                         (1.+tbp%c02/tbp%d02-tbp%c02/(tbp%d02+(1.+sum(nl%dr(:,p,i)*nl%dr(:,q,i))/(nl%moddr(p
      ,i)*nl%moddr(q,i)))**2)) 
91 \textcolor{keywordflow}{                    endif}
92 \textcolor{keywordflow}{                enddo}
93                 b(p,i) = (1.+tbp%a0*b(p,i))**(-tbp%delt)
94 \textcolor{keywordflow}{            endif}
95 \textcolor{keywordflow}{        enddo}
96 \textcolor{keywordflow}{    enddo}
97     \textcolor{comment}{!$OMP END DO    }
98     \textcolor{comment}{!$OMP DO}
99     \textcolor{keywordflow}{do} i=1,nl%N 
100         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
101             db=0.d0
102             \textcolor{keywordflow}{do} q=1,nl%nnum(i)
103                 \textcolor{keywordflow}{if} (p/=q) \textcolor{keywordflow}{then}
104                     rr = 1./nl%moddr(p,i)/nl%moddr(q,i)
105                     cosi = sum(nl%dr(:,p,i)*nl%dr(:,q,i))*rr
106                     db = db+ f\_cut(nl%moddr(q,i),tbp%R1,tbp%R2)*2.d0*tbp%a0*tbp%c02*(1.+cosi)/(tbp%d02+(1.+
      cosi)**2)**2*&
107                         ( (nl%dr(:,p,i)+nl%dr(:,q,i))*rr-cosi*(nl%dr(:,p,i)/nl%moddr(p,i)**2+nl%dr(:,q,i)/
      nl%moddr(q,i)**2) )&
108                         + df\_cut(nl%moddr(q,i),tbp%R1,tbp%R2)*tbp%a0*(1.+tbp%c02/tbp%d02-tbp%c02/(tbp%d02+(
      1.+cosi)**2))*nl%dr(:,q,i)
109 \textcolor{keywordflow}{                endif}
110 \textcolor{keywordflow}{            enddo}
111             db=db*b(p,i)**(1./tbp%delt+1.)
112             j=nl%nlist(p,i)
113             \textcolor{keywordflow}{do} l=1,nl%nnum(j)
114                 \textcolor{keywordflow}{if}(nl%nlist(l,j)==i) \textcolor{keywordflow}{exit}
115 \textcolor{keywordflow}{            enddo}
116             \textcolor{keywordflow}{do} q=1,nl%nnum(j)
117                 \textcolor{keywordflow}{if} (q/=l) \textcolor{keywordflow}{then}
118                     rr = 1./nl%moddr(l,j)/nl%moddr(q,j)
119                     cosi = sum(nl%dr(:,l,j)*nl%dr(:,q,j))*rr 
120                     db = db+(b(l,j)**(1./tbp%delt+1.)*f\_cut(nl%moddr(q,j),tbp%R1,tbp%R2)*&
121                         2.*tbp%a0*tbp%c02*(1.+cosi)/(tbp%d02+(1.+cosi)**2)**2)*(-nl%dr(:,q,j)*rr + cosi*nl
      %dr(:,l,j)/nl%moddr(l,j)**2)
122 \textcolor{keywordflow}{                endif}
123 \textcolor{keywordflow}{            enddo}
124             db = db*(-tbp%delt)/2.
125             \textcolor{keywordflow}{if} (nl%moddr(p,i)<tbp%R2) \textcolor{keywordflow}{then}
126                 f\_c = f\_cut(nl%moddr(p,i),tbp%R1,tbp%R2)
127                 dff = df\_cut(nl%moddr(p,i),tbp%R1,tbp%R2)/f\_c
128                 a = -sqrt(2.*tbp%s)*tbp%b*(nl%moddr(p,i)-tbp%r0)
129                 atoms%forces(:,nl%particle\_index(i)) = atoms%forces(:,nl%particle\_index(i))+&
130                 f\_c*tbp%d/(tbp%s-1.)*((nl%dr(:,p,i)*dff-sqrt(2.*tbp%s)*tbp%b/nl%moddr(p,i)*nl%dr(:,p,i))*
      exp(a)&
131                 -( db+(b(p,i)+b(l,j))/2*(nl%dr(:,p,i)*dff-sqrt(2./tbp%s)*tbp%b/nl%moddr(p,i)*nl%dr(:,p,i)) 
      )*tbp%s*exp(a/tbp%s))
132 \textcolor{keywordflow}{            endif}
133             \textcolor{keywordflow}{do} q=1,nl%nnum(j)
134                 \textcolor{keywordflow}{if} (q/=l) \textcolor{keywordflow}{then}  
135                     f\_c = f\_cut(nl%moddr(l,j),tbp%R1,tbp%R2)
136                     df\_c = df\_cut(nl%moddr(l,j),tbp%R1,tbp%R2)
137                     rr = 1./nl%moddr(l,j)/nl%moddr(q,j)
138                     cosi = sum(nl%dr(:,l,j)*nl%dr(:,q,j))*rr                
139                     atoms%forces(:,nl%particle\_index(i)) = atoms%forces(:,nl%particle\_index(i))+tbp%delt/2*
      b(q,j)**(1./tbp%delt+1.)*&
140                     ( f\_c*2.*tbp%a0*tbp%c02*(1.+cosi)/(tbp%d02+(1.+cosi)**2)**2 *( -nl%dr(:,q,j)*rr + cosi*
      nl%dr(:,l,j)/nl%moddr(l,j)**2 )+&
141                     nl%dr(:,p,i)*df\_c*tbp%a0*(1.+tbp%c02/tbp%d02-tbp%c02/(tbp%d02+(1.+cosi)**2)) )*&
142                     f\_cut(nl%moddr(q,j),tbp%R1,tbp%R2)*tbp%d/(tbp%s-1.)*tbp%s*exp(-sqrt(2.*tbp%s)*tbp%b*(nl
      %moddr(q,j)-tbp%r0)/tbp%s)
143 \textcolor{keywordflow}{                endif}
144 \textcolor{keywordflow}{            enddo}       
145 \textcolor{keywordflow}{        enddo}
146 \textcolor{keywordflow}{    enddo}
147     \textcolor{comment}{!$OMP END DO}
148     \textcolor{comment}{!$OMP END PARALLEL}
149     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{namespacetersoffbrenner_a1edc8ac251b3fa58026839db4d23f12a_cgraph}
\end{center}
\end{figure}
