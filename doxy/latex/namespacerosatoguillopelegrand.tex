\hypertarget{namespacerosatoguillopelegrand}{}\section{Модуль rosatoguillopelegrand}
\label{namespacerosatoguillopelegrand}\index{rosatoguillopelegrand@{rosatoguillopelegrand}}
\subsection*{Типы данных}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structrosatoguillopelegrand_1_1rosatoguillopelegrand__parameters}{rosatoguillopelegrand\+\_\+parameters}}
\end{DoxyCompactItemize}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacerosatoguillopelegrand_ac5fa55316f7b8e860b3131c6f95c10ae}{read\+\_\+rjl\+\_\+parameters}} (R\+J\+Lp, filename)
\item 
subroutine \mbox{\hyperlink{namespacerosatoguillopelegrand_a06b6c23e50e301e053ed9ccb60e1ca34}{rjl\+\_\+energy}} (energy, nl, R\+J\+Lp)
\item 
subroutine \mbox{\hyperlink{namespacerosatoguillopelegrand_a3744fc3d1e6df3ca288ddc43df483ca0}{rjl\+\_\+forces}} (atoms, nl, R\+J\+Lp)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacerosatoguillopelegrand_ac5fa55316f7b8e860b3131c6f95c10ae}\label{namespacerosatoguillopelegrand_ac5fa55316f7b8e860b3131c6f95c10ae}} 
\index{rosatoguillopelegrand@{rosatoguillopelegrand}!read\+\_\+rjl\+\_\+parameters@{read\+\_\+rjl\+\_\+parameters}}
\index{read\+\_\+rjl\+\_\+parameters@{read\+\_\+rjl\+\_\+parameters}!rosatoguillopelegrand@{rosatoguillopelegrand}}
\subsubsection{\texorpdfstring{read\+\_\+rjl\+\_\+parameters()}{read\_rjl\_parameters()}}
{\footnotesize\ttfamily subroutine rosatoguillopelegrand\+::read\+\_\+rjl\+\_\+parameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrosatoguillopelegrand_1_1rosatoguillopelegrand__parameters}{rosatoguillopelegrand\+\_\+parameters}})}]{R\+J\+Lp,  }\item[{character($\ast$)}]{filename }\end{DoxyParamCaption})}



См. определение в файле Rosato\+Guillope\+Legrand.\+f90 строка 13


\begin{DoxyCode}
13     \textcolor{keywordtype}{type}(RosatoGuillopeLegrand\_parameters):: RJLp
14     \textcolor{keywordtype}{character(*)}::  filename
15     
16     \textcolor{keyword}{open}(1,file=filename)
17     \textcolor{keyword}{read}(1,*) rjlp%A0,rjlp%xi,rjlp%p,rjlp%q,rjlp%r0
18     \textcolor{keyword}{read}(1,*) rjlp%R1,rjlp%R2
19     \textcolor{keyword}{close}(1)
20     
\end{DoxyCode}
\mbox{\Hypertarget{namespacerosatoguillopelegrand_a06b6c23e50e301e053ed9ccb60e1ca34}\label{namespacerosatoguillopelegrand_a06b6c23e50e301e053ed9ccb60e1ca34}} 
\index{rosatoguillopelegrand@{rosatoguillopelegrand}!rjl\+\_\+energy@{rjl\+\_\+energy}}
\index{rjl\+\_\+energy@{rjl\+\_\+energy}!rosatoguillopelegrand@{rosatoguillopelegrand}}
\subsubsection{\texorpdfstring{rjl\+\_\+energy()}{rjl\_energy()}}
{\footnotesize\ttfamily subroutine rosatoguillopelegrand\+::rjl\+\_\+energy (\begin{DoxyParamCaption}\item[{real}]{energy,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structrosatoguillopelegrand_1_1rosatoguillopelegrand__parameters}{rosatoguillopelegrand\+\_\+parameters}})}]{R\+J\+Lp }\end{DoxyParamCaption})}



См. определение в файле Rosato\+Guillope\+Legrand.\+f90 строка 24


\begin{DoxyCode}
24     \textcolor{keywordtype}{type}(RosatoGuillopeLegrand\_parameters):: RJLp
25     \textcolor{keywordtype}{type}(neighbour\_list):: nl
26     \textcolor{keywordtype}{integer}:: i,p
27     \textcolor{keywordtype}{real}:: energy,energy\_priv,Eb2,Er
28     
29     energy = 0.
30     energy\_priv = 0.
31     \textcolor{comment}{!$OMP PARALLEL firstprivate(energy\_priv,i,p,Eb2,Er)}
32     \textcolor{comment}{!$OMP DO}
33     \textcolor{keywordflow}{do} i=1,nl%N
34         eb2 = 0.
35         er = 0.
36         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
37             \textcolor{keywordflow}{if}( nl%moddr(p,i)<=rjlp%R2 ) \textcolor{keywordflow}{then}
38                 eb2 = eb2+exp(-2.*rjlp%q*(nl%moddr(p,i)/rjlp%r0-1.))*f\_cut(nl%moddr(p,i),rjlp%R1,rjlp%R2)
39                 er = er+exp(-rjlp%p*(nl%moddr(p,i)/rjlp%r0-1.))*f\_cut(nl%moddr(p,i),rjlp%R1,rjlp%R2)
40 \textcolor{keywordflow}{            endif}
41 \textcolor{keywordflow}{        enddo}
42         energy\_priv = energy\_priv+rjlp%A0*er-rjlp%xi*sqrt(eb2)
43 \textcolor{keywordflow}{    enddo}
44     \textcolor{comment}{!$OMP END DO}
45     \textcolor{comment}{!$OMP ATOMIC}
46         energy = energy+energy\_priv
47     \textcolor{comment}{!$OMP END PARALLEL}
48     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespacerosatoguillopelegrand_a06b6c23e50e301e053ed9ccb60e1ca34_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerosatoguillopelegrand_a3744fc3d1e6df3ca288ddc43df483ca0}\label{namespacerosatoguillopelegrand_a3744fc3d1e6df3ca288ddc43df483ca0}} 
\index{rosatoguillopelegrand@{rosatoguillopelegrand}!rjl\+\_\+forces@{rjl\+\_\+forces}}
\index{rjl\+\_\+forces@{rjl\+\_\+forces}!rosatoguillopelegrand@{rosatoguillopelegrand}}
\subsubsection{\texorpdfstring{rjl\+\_\+forces()}{rjl\_forces()}}
{\footnotesize\ttfamily subroutine rosatoguillopelegrand\+::rjl\+\_\+forces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structrosatoguillopelegrand_1_1rosatoguillopelegrand__parameters}{rosatoguillopelegrand\+\_\+parameters}})}]{R\+J\+Lp }\end{DoxyParamCaption})}



См. определение в файле Rosato\+Guillope\+Legrand.\+f90 строка 52


\begin{DoxyCode}
52     \textcolor{keywordtype}{type}(RosatoGuillopeLegrand\_parameters):: RJLp
53     \textcolor{keywordtype}{type}(particles)::   atoms
54     \textcolor{keywordtype}{type}(neighbour\_list):: nl
55     \textcolor{keywordtype}{integer}:: i,p
56     \textcolor{keywordtype}{real}:: fc,dfc,Eb(nl%N),expp(nl%neighb\_num\_max,nl%N),expq(nl%neighb\_num\_max,nl%N)
57     
58     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,p,fc,dfc)}
59     \textcolor{comment}{!$OMP DO}
60     \textcolor{keywordflow}{do} i=1,nl%N
61         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
62             \textcolor{keywordflow}{if}( nl%moddr(p,i)<=rjlp%R2 ) \textcolor{keywordflow}{then}
63                 expq(p,i) = exp(-2.*rjlp%q*(nl%moddr(p,i)/rjlp%r0-1.))
64                 expp(p,i) = exp(-rjlp%p*(nl%moddr(p,i)/rjlp%r0-1.))
65 \textcolor{keywordflow}{            endif}
66 \textcolor{keywordflow}{        enddo}
67 \textcolor{keywordflow}{    enddo}
68     \textcolor{comment}{!$OMP END DO}
69     \textcolor{comment}{!$OMP DO    }
70     \textcolor{keywordflow}{do} i=1,nl%N
71         eb(i) = 0.
72         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
73             \textcolor{keywordflow}{if}( nl%moddr(p,i)<=rjlp%R2 ) \textcolor{keywordflow}{then}
74                 eb(i) = eb(i)+expq(p,i)*f\_cut(nl%moddr(p,i),rjlp%R1,rjlp%R2)
75 \textcolor{keywordflow}{            endif}
76 \textcolor{keywordflow}{        enddo}
77         eb(i) = sqrt(eb(i))
78 \textcolor{keywordflow}{    enddo}
79     \textcolor{comment}{!$OMP END DO}
80     \textcolor{comment}{!$OMP DO    }
81     \textcolor{keywordflow}{do} i=1,nl%N
82         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
83             \textcolor{keywordflow}{if}( nl%moddr(p,i)<=rjlp%R2 ) \textcolor{keywordflow}{then}
84                 fc = f\_cut(nl%moddr(p,i),rjlp%R1,rjlp%R2)
85                 dfc = df\_cut(nl%moddr(p,i),rjlp%R1,rjlp%R2)
86                 atoms%forces(:,nl%particle\_index(i)) = atoms%forces(:,nl%particle\_index(i))&
87                 -(2.*rjlp%A0*(rjlp%p/rjlp%r0*fc-dfc*nl%moddr(p,i))*expp(p,i)&
88                 -rjlp%xi*(rjlp%q/rjlp%r0*fc-dfc/2.*nl%moddr(p,i))*(1./eb(i)+1./eb(nl%nlist(p,i)))*expq(p,i)
      )/nl%moddr(p,i)*nl%dr(:,p,i)
89 \textcolor{keywordflow}{            endif}
90 \textcolor{keywordflow}{        enddo}
91 \textcolor{keywordflow}{    enddo}
92     \textcolor{comment}{!$OMP END DO}
93     \textcolor{comment}{!$OMP END PARALLEL}
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{namespacerosatoguillopelegrand_a3744fc3d1e6df3ca288ddc43df483ca0_cgraph}
\end{center}
\end{figure}
