\hypertarget{namespacegraphenenorm}{}\section{Модуль graphenenorm}
\label{namespacegraphenenorm}\index{graphenenorm@{graphenenorm}}
\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacegraphenenorm_afb5708c33c6fe9d316e999710adeeef5}{find\+\_\+gr\+\_\+nearest\+\_\+neighbors}} (nl\+\_\+nn, nl)
\item 
subroutine \mbox{\hyperlink{namespacegraphenenorm_a6005cfed33b7112df95442616a990b5b}{find\+\_\+norm\+\_\+in\+\_\+graphene}} (gr\+\_\+norm, dr\+\_\+nn)
\item 
subroutine \mbox{\hyperlink{namespacegraphenenorm_a16d22fddd4c9f90cdf1236130515fd24}{update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene}} (md\+\_\+step, nl\+\_\+nn, nl, atoms, group, box)
\end{DoxyCompactItemize}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacegraphenenorm_afb5708c33c6fe9d316e999710adeeef5}\label{namespacegraphenenorm_afb5708c33c6fe9d316e999710adeeef5}} 
\index{graphenenorm@{graphenenorm}!find\+\_\+gr\+\_\+nearest\+\_\+neighbors@{find\+\_\+gr\+\_\+nearest\+\_\+neighbors}}
\index{find\+\_\+gr\+\_\+nearest\+\_\+neighbors@{find\+\_\+gr\+\_\+nearest\+\_\+neighbors}!graphenenorm@{graphenenorm}}
\subsubsection{\texorpdfstring{find\+\_\+gr\+\_\+nearest\+\_\+neighbors()}{find\_gr\_nearest\_neighbors()}}
{\footnotesize\ttfamily subroutine graphenenorm\+::find\+\_\+gr\+\_\+nearest\+\_\+neighbors (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl\+\_\+nn,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl }\end{DoxyParamCaption})}



См. определение в файле graphenenorm.\+f90 строка 9


\begin{DoxyCode}
9     \textcolor{keywordtype}{type}(neighbour\_list):: nl,nl\_nn
10     \textcolor{keywordtype}{integer}:: nnum\_nn,i,p,k 
11     
12     nnum\_nn = 3
13     \textcolor{keywordflow}{if}(nl\_nn%neighb\_num\_max/=nnum\_nn) then; \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'error: nl\_nn%neighb\_num\_max/=nnum\_nn'}; stop;\textcolor{keywordflow}{ endif}
14     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,p,k)}
15     \textcolor{comment}{!$OMP DO}
16     \textcolor{keywordflow}{do} i=1,nl%N
17         k = 0
18         \textcolor{keywordflow}{do} p=1,nl%nnum(i)
19             \textcolor{keywordflow}{if} (nl%moddr(p,i)<nl\_nn%r\_cut) \textcolor{keywordflow}{then}
20                 k = k+1
21                 \textcolor{keywordflow}{if} (k<=nnum\_nn) \textcolor{keywordflow}{then}
22                     nl\_nn%nlist(k,i) = nl%nlist(p,i)
23                     nl\_nn%moddr(k,i) = nl%moddr(p,i)
24                     nl\_nn%dr(:,k,i) = nl%dr(:,p,i)
25                 \textcolor{keywordflow}{else}
26                     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'error: too many gr nearest neibs'},i,p,nl%moddr(p,i); stop;
27 \textcolor{keywordflow}{                endif}
28 \textcolor{keywordflow}{            endif}
29 \textcolor{keywordflow}{        enddo}
30         \textcolor{keywordflow}{if} (k/=nnum\_nn) then; \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'error: not enough gr nearest neibs'},i,nl\_nn%moddr(:,i),nl\_nn
      %nlist(:,i); stop; endif;
31         nl\_nn%nnum(i) = nnum\_nn
32 \textcolor{keywordflow}{    enddo}
33     \textcolor{comment}{!$OMP END DO}
34     \textcolor{comment}{!$OMP END PARALLEL}
35     
\end{DoxyCode}
\mbox{\Hypertarget{namespacegraphenenorm_a6005cfed33b7112df95442616a990b5b}\label{namespacegraphenenorm_a6005cfed33b7112df95442616a990b5b}} 
\index{graphenenorm@{graphenenorm}!find\+\_\+norm\+\_\+in\+\_\+graphene@{find\+\_\+norm\+\_\+in\+\_\+graphene}}
\index{find\+\_\+norm\+\_\+in\+\_\+graphene@{find\+\_\+norm\+\_\+in\+\_\+graphene}!graphenenorm@{graphenenorm}}
\subsubsection{\texorpdfstring{find\+\_\+norm\+\_\+in\+\_\+graphene()}{find\_norm\_in\_graphene()}}
{\footnotesize\ttfamily subroutine graphenenorm\+::find\+\_\+norm\+\_\+in\+\_\+graphene (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:)}]{gr\+\_\+norm,  }\item[{real, dimension(\+:,\+:,\+:)}]{dr\+\_\+nn }\end{DoxyParamCaption})}



См. определение в файле graphenenorm.\+f90 строка 39


\begin{DoxyCode}
39     \textcolor{keywordtype}{integer}:: nnum\_nn,i,p,k
40     \textcolor{keywordtype}{real}:: dr\_nn(:,:,:),gr\_norm(:,:),drj12(3),drj31(3)
41     
42     nnum\_nn = 3
43     \textcolor{comment}{!$OMP PARALLEL firstprivate(i,p,k,drj12,drj31)}
44     \textcolor{comment}{!$OMP DO}
45     \textcolor{keywordflow}{do} i=1,\textcolor{keyword}{size}(gr\_norm(1,:))
46         drj12 = dr\_nn(:,2,i)-dr\_nn(:,1,i)
47         drj31 = dr\_nn(:,1,i)-dr\_nn(:,3,i)
48         \textcolor{keywordflow}{do} k=1,3
49             gr\_norm(k,i) = (drj12(mod(k,3)+1))*(drj31(mod(k+1,3)+1))-(drj12(mod(k+1,3)+1))*(drj31(mod(k,3)+
      1))
50 \textcolor{keywordflow}{        enddo}
51         \textcolor{keywordflow}{if} (gr\_norm(3,i)<0.) gr\_norm(:,i)=-gr\_norm(:,i)
52         gr\_norm(:,i) = gr\_norm(:,i)/sqrt(sum(gr\_norm(:,i)**2))
53 \textcolor{keywordflow}{    enddo}
54     \textcolor{comment}{!$OMP END DO}
55     \textcolor{comment}{!$OMP END PARALLEL  }
\end{DoxyCode}
\mbox{\Hypertarget{namespacegraphenenorm_a16d22fddd4c9f90cdf1236130515fd24}\label{namespacegraphenenorm_a16d22fddd4c9f90cdf1236130515fd24}} 
\index{graphenenorm@{graphenenorm}!update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene@{update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene}}
\index{update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene@{update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene}!graphenenorm@{graphenenorm}}
\subsubsection{\texorpdfstring{update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene()}{update\_nearest\_neighbours\_in\_graphene()}}
{\footnotesize\ttfamily subroutine graphenenorm\+::update\+\_\+nearest\+\_\+neighbours\+\_\+in\+\_\+graphene (\begin{DoxyParamCaption}\item[{integer}]{md\+\_\+step,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl\+\_\+nn,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1neighbour__list}{neighbour\+\_\+list}})}]{nl,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box }\end{DoxyParamCaption})}



См. определение в файле graphenenorm.\+f90 строка 59


\begin{DoxyCode}
59     \textcolor{keywordtype}{type}(particles)::   atoms
60     \textcolor{keywordtype}{type}(neighbour\_list):: nl,nl\_nn
61     \textcolor{keywordtype}{type}(particle\_group):: group
62     \textcolor{keywordtype}{type}(simulation\_cell):: box
63     \textcolor{keywordtype}{integer}:: md\_step
64 
65     \textcolor{keywordflow}{if} (mod(md\_step,nl%update\_period)==0) \textcolor{keywordflow}{then}
66         \textcolor{keyword}{call }find\_gr\_nearest\_neighbors(nl\_nn,nl)
67     \textcolor{keywordflow}{else}
68         \textcolor{keyword}{call }find\_neighbour\_distances(nl\_nn,atoms,group,group,box)
69 \textcolor{keywordflow}{    endif}
70     
\end{DoxyCode}
Граф вызовов\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegraphenenorm_a16d22fddd4c9f90cdf1236130515fd24_cgraph}
\end{center}
\end{figure}
