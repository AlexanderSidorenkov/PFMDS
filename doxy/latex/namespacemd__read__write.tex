\hypertarget{namespacemd__read__write}{}\section{Модуль md\+\_\+read\+\_\+write}
\label{namespacemd__read__write}\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}


Модуль ввода вывода .xyz файлов и настроек моделирования.  


\subsection*{Функции/подпрограммы}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacemd__read__write_a13e739c9b44b3100ee36e864eac3d5e0}{read\+\_\+integrator\+\_\+params}} (integr, file\+\_\+id)
\begin{DoxyCompactList}\small\item\em Читает параметры интегратора. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemd__read__write_ace09a29b4fd526f8ed784c90098279c4}{read\+\_\+box\+\_\+size}} (box, filename)
\begin{DoxyCompactList}\small\item\em Читает параметры моделируемой ячейки в файле .xyz.  Читает второю строку в xyz файле. В размер ячейки задается тремя векторами. В общем случае ячейка триклинная. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemd__read__write_a1a0fd7df876318fd4247d110936384d8}{read\+\_\+particles}} (atoms, filename)
\begin{DoxyCompactList}\small\item\em Читает информацию о частицах из .xyz файла.  Первая строка файла содержит количество частиц. Третья и последующие -\/ координаты по X, Y, Z, скорости по X, Y, Z, массу и название частицы. Всего 8 столбцов для каждой частицы. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemd__read__write_a20f73c896cf124f2e1da6ccbf23cc12d}{write\+\_\+particle\+\_\+group}} (filename, atoms, group, box)
\begin{DoxyCompactList}\small\item\em Выводит информацию о группе частиц в новый файл. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemd__read__write_a24453b47bb1935e66563cd522e09e3af}{write\+\_\+particle\+\_\+group\+\_\+append}} (filename, atoms, group, box, md\+\_\+step)
\begin{DoxyCompactList}\small\item\em Выводит информацию о группе частиц в конец уже имеющегося файла. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Подробное описание}
Модуль ввода вывода .xyz файлов и настроек моделирования. 

\begin{DoxyRefDesc}{Необходимо сделать}
\item[\mbox{\hyperlink{todo__todo000002}{Необходимо сделать}}]Добавить чтение файла настроек. \end{DoxyRefDesc}


\subsection{Функции/подпрограммы}
\mbox{\Hypertarget{namespacemd__read__write_ace09a29b4fd526f8ed784c90098279c4}\label{namespacemd__read__write_ace09a29b4fd526f8ed784c90098279c4}} 
\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}!read\+\_\+box\+\_\+size@{read\+\_\+box\+\_\+size}}
\index{read\+\_\+box\+\_\+size@{read\+\_\+box\+\_\+size}!md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}
\subsubsection{\texorpdfstring{read\+\_\+box\+\_\+size()}{read\_box\_size()}}
{\footnotesize\ttfamily subroutine md\+\_\+read\+\_\+write\+::read\+\_\+box\+\_\+size (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box,  }\item[{character($\ast$)}]{filename }\end{DoxyParamCaption})}



Читает параметры моделируемой ячейки в файле .xyz.  Читает второю строку в xyz файле. В размер ячейки задается тремя векторами. В общем случае ячейка триклинная. 

\begin{DoxyWarning}{Предупреждения}
Данная подпрограмма (как и вся программа) рассчитана только на прямоугольные ячейки. 
\end{DoxyWarning}


См. определение в файле md\+\_\+read\+\_\+write.\+f90 строка 23


\begin{DoxyCode}
23     \textcolor{keywordtype}{type}(simulation\_cell):: box
24     \textcolor{keywordtype}{real}:: boxmatrix(9)
25     \textcolor{keywordtype}{character(*)}::  filename
26     \textcolor{keywordtype}{character(len=32)}:: c
27 
28     \textcolor{keyword}{open}(1,file=filename)
29     \textcolor{keyword}{read}(1,*)
30     \textcolor{keyword}{read}(1,*) c,boxmatrix
31     \textcolor{keyword}{close}(1)
32     box%box\_size(1)=boxmatrix(1)
33     box%box\_size(2)=boxmatrix(5)
34     box%box\_size(3)=boxmatrix(9)
35     box%half\_box\_size = 0.5*box%box\_size
36     
37     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__read__write_a13e739c9b44b3100ee36e864eac3d5e0}\label{namespacemd__read__write_a13e739c9b44b3100ee36e864eac3d5e0}} 
\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}!read\+\_\+integrator\+\_\+params@{read\+\_\+integrator\+\_\+params}}
\index{read\+\_\+integrator\+\_\+params@{read\+\_\+integrator\+\_\+params}!md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}
\subsubsection{\texorpdfstring{read\+\_\+integrator\+\_\+params()}{read\_integrator\_params()}}
{\footnotesize\ttfamily subroutine md\+\_\+read\+\_\+write\+::read\+\_\+integrator\+\_\+params (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1integrator__params}{integrator\+\_\+params}})}]{integr,  }\item[{integer}]{file\+\_\+id }\end{DoxyParamCaption})}



Читает параметры интегратора. 



См. определение в файле md\+\_\+read\+\_\+write.\+f90 строка 11


\begin{DoxyCode}
11     \textcolor{keywordtype}{type}(integrator\_params):: integr
12     \textcolor{keywordtype}{integer}:: file\_id 
13 
14     \textcolor{keyword}{read}(file\_id,*) integr%int\_name,integr%dt,integr%l,integr%period\_snapshot,integr%period\_log
15 
16     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__read__write_a1a0fd7df876318fd4247d110936384d8}\label{namespacemd__read__write_a1a0fd7df876318fd4247d110936384d8}} 
\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}!read\+\_\+particles@{read\+\_\+particles}}
\index{read\+\_\+particles@{read\+\_\+particles}!md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}
\subsubsection{\texorpdfstring{read\+\_\+particles()}{read\_particles()}}
{\footnotesize\ttfamily subroutine md\+\_\+read\+\_\+write\+::read\+\_\+particles (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{character($\ast$)}]{filename }\end{DoxyParamCaption})}



Читает информацию о частицах из .xyz файла.  Первая строка файла содержит количество частиц. Третья и последующие -\/ координаты по X, Y, Z, скорости по X, Y, Z, массу и название частицы. Всего 8 столбцов для каждой частицы. 



См. определение в файле md\+\_\+read\+\_\+write.\+f90 строка 43


\begin{DoxyCode}
43     \textcolor{keywordtype}{type}(particles)::   atoms
44     \textcolor{keywordtype}{character(*)}::  filename
45     \textcolor{keywordtype}{integer}::       i
46 
47     \textcolor{keyword}{open}(1,file=filename)
48     \textcolor{keyword}{read}(1,*) atoms%N
49     \textcolor{keyword}{allocate}(atoms%positions(3,atoms%N))
50     \textcolor{keyword}{allocate}(atoms%velocities(3,atoms%N))
51     \textcolor{keyword}{allocate}(atoms%forces(3,atoms%N))
52     \textcolor{keyword}{allocate}(atoms%masses(atoms%N))
53     \textcolor{keyword}{allocate}(atoms%atom\_types(atoms%N))
54     \textcolor{keyword}{read}(1,*)
55     \textcolor{keywordflow}{do} i=1,atoms%N
56         \textcolor{keyword}{read}(1,*) atoms%positions(:,i),atoms%velocities(:,i),atoms%masses(i),atoms%atom\_types(i)
57 \textcolor{keywordflow}{    enddo}
58     \textcolor{keyword}{close}(1)
59 
60     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__read__write_a20f73c896cf124f2e1da6ccbf23cc12d}\label{namespacemd__read__write_a20f73c896cf124f2e1da6ccbf23cc12d}} 
\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}!write\+\_\+particle\+\_\+group@{write\+\_\+particle\+\_\+group}}
\index{write\+\_\+particle\+\_\+group@{write\+\_\+particle\+\_\+group}!md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}
\subsubsection{\texorpdfstring{write\+\_\+particle\+\_\+group()}{write\_particle\_group()}}
{\footnotesize\ttfamily subroutine md\+\_\+read\+\_\+write\+::write\+\_\+particle\+\_\+group (\begin{DoxyParamCaption}\item[{character($\ast$)}]{filename,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box }\end{DoxyParamCaption})}



Выводит информацию о группе частиц в новый файл. 

\begin{DoxyWarning}{Предупреждения}
Если файл с таким именем уже существует, он будет заменен новым. 
\end{DoxyWarning}


См. определение в файле md\+\_\+read\+\_\+write.\+f90 строка 66


\begin{DoxyCode}
66     \textcolor{keywordtype}{type}(particles)::   atoms
67     \textcolor{keywordtype}{type}(particle\_group)::  group
68     \textcolor{keywordtype}{type}(simulation\_cell):: box
69     \textcolor{keywordtype}{character(*)}::  filename
70     \textcolor{keywordtype}{integer}::       i,ind
71 
72     \textcolor{keyword}{open}(2,file=filename)
73     \textcolor{keyword}{write}(2,*) group%N
74     \textcolor{keyword}{write}(2,\textcolor{stringliteral}{'(A,9f16.6,A)'}) \textcolor{stringliteral}{'Lattice="'},box%box\_size(1), 0., 0., 0., box%box\_size(2), 0., 0., 0., box
      %box\_size(3),&
75             \textcolor{stringliteral}{' " Properties=pos:R:3:vel:R:3:mass:R:1:species:S:1'}
76     \textcolor{keywordflow}{do} ind=1,group%N
77         i = group%indexes(ind)
78         \textcolor{keyword}{write}(2,\textcolor{stringliteral}{'(7f27.16,A,A)'}) atoms%positions(:,i),atoms%velocities(:,i),atoms%masses(i),\textcolor{stringliteral}{'    '},atoms
      %atom\_types(i)
79 \textcolor{keywordflow}{    enddo}
80     \textcolor{keyword}{close}(2)
81 
82     \textcolor{keywordflow}{return}
\end{DoxyCode}
\mbox{\Hypertarget{namespacemd__read__write_a24453b47bb1935e66563cd522e09e3af}\label{namespacemd__read__write_a24453b47bb1935e66563cd522e09e3af}} 
\index{md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}!write\+\_\+particle\+\_\+group\+\_\+append@{write\+\_\+particle\+\_\+group\+\_\+append}}
\index{write\+\_\+particle\+\_\+group\+\_\+append@{write\+\_\+particle\+\_\+group\+\_\+append}!md\+\_\+read\+\_\+write@{md\+\_\+read\+\_\+write}}
\subsubsection{\texorpdfstring{write\+\_\+particle\+\_\+group\+\_\+append()}{write\_particle\_group\_append()}}
{\footnotesize\ttfamily subroutine md\+\_\+read\+\_\+write\+::write\+\_\+particle\+\_\+group\+\_\+append (\begin{DoxyParamCaption}\item[{character($\ast$)}]{filename,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particles}{particles}})}]{atoms,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1particle__group}{particle\+\_\+group}})}]{group,  }\item[{type(\mbox{\hyperlink{structmd__general_1_1simulation__cell}{simulation\+\_\+cell}})}]{box,  }\item[{integer}]{md\+\_\+step }\end{DoxyParamCaption})}



Выводит информацию о группе частиц в конец уже имеющегося файла. 



См. определение в файле md\+\_\+read\+\_\+write.\+f90 строка 87


\begin{DoxyCode}
87     \textcolor{keywordtype}{type}(particles)::   atoms
88     \textcolor{keywordtype}{type}(particle\_group)::  group
89     \textcolor{keywordtype}{type}(simulation\_cell):: box
90     \textcolor{keywordtype}{character(*)}::  filename
91     \textcolor{keywordtype}{integer}::       i,ind,md\_step
92 
93     \textcolor{keywordflow}{if}(group%N>0) \textcolor{keywordflow}{then}
94         \textcolor{keyword}{open}(2,file=filename,action=\textcolor{stringliteral}{'write'},position=\textcolor{stringliteral}{'append'})
95         \textcolor{keyword}{write}(2,*) group%N
96         \textcolor{keyword}{write}(2,\textcolor{stringliteral}{'(A,i9,A,9f10.4,A)'}) \textcolor{stringliteral}{'time\_step: '},md\_step,&
97         \textcolor{stringliteral}{'    Lattice="'},box%box\_size(1), 0., 0., 0., box%box\_size(2), 0., 0., 0., box%box\_size(3),&
98         \textcolor{stringliteral}{' " Properties=pos:R:3:vel:R:3:mass:R:1:species:S:1'}
99         \textcolor{keywordflow}{do} ind=1,group%N
100             i = group%indexes(ind)
101             \textcolor{keyword}{write}(2,\textcolor{stringliteral}{'(7f10.4,A,A)'}) atoms%positions(:,i),atoms%velocities(:,i),atoms%masses(i),\textcolor{stringliteral}{'    '},trim(
      atoms%atom\_types(i))
102 \textcolor{keywordflow}{        enddo}
103         \textcolor{keyword}{close}(2)
104 \textcolor{keywordflow}{    endif}
105     
106     \textcolor{keywordflow}{return}
\end{DoxyCode}
